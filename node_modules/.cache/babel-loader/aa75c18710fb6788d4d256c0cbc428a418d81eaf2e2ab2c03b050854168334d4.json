{"ast":null,"code":"import _objectSpread from\"C:/Users/ResTIC16/Desktop/gest-o-financeira/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// ============================================\n// SERVIÇO COMPLETO DE CONFIGURAÇÕES DE EMAIL\n// src/services/emailSettingsService.js\n// ============================================\nimport{supabase}from'../lib/supabaseClient';export const emailSettingsService={// ==================== CONFIGURAÇÕES GLOBAIS ====================\n// Buscar configurações do usuário\nasync getSettings(){try{const{data:{user}}=await supabase.auth.getUser();// Ajuste: Verificação de usuário para evitar erro de leitura de null\nif(!user)return{data:null,error:'Usuário não autenticado'};let{data,error}=await supabase.from('email_settings').select('*').eq('user_id',user.id).single();// Se não existir, criar configurações padrão\nif(error&&error.code==='PGRST116'){const{data:newSettings,error:createError}=await supabase.from('email_settings').insert([{user_id:user.id,lembrete_vencimento_ativo:true,lembrete_dias_antecedencia:3,cobranca_atraso_ativo:true,relatorio_semanal_ativo:true,relatorio_dia_semana:1,horario_envio:'09:00:00'}]).select().single();if(createError)throw createError;return{data:newSettings,error:null};}if(error)throw error;return{data,error:null};}catch(error){console.error('Erro ao buscar configurações:',error);return{data:null,error:error.message};}},// Atualizar configurações\nasync updateSettings(settings){try{const{data:{user}}=await supabase.auth.getUser();const{data,error}=await supabase.from('email_settings').update(settings).eq('user_id',user.id).select().single();if(error)throw error;return{data,error:null};}catch(error){console.error('Erro ao atualizar configurações:',error);return{data:null,error:error.message};}},// ==================== EXCEÇÕES POR CLIENTE ====================\n// Buscar exceção de um cliente específico\nasync getClientException(clienteId){try{const{data:{user}}=await supabase.auth.getUser();if(!user)return{data:null,error:null};const{data,error}=await supabase.from('email_exceptions').select('*').eq('user_id',user.id).eq('cliente_id',clienteId).single();if(error&&error.code==='PGRST116'){// Não existe exceção para este cliente\nreturn{data:null,error:null};}if(error)throw error;return{data,error:null};}catch(error){console.error('Erro ao buscar exceção do cliente:',error);return{data:null,error:error.message};}},// Criar ou atualizar exceção de cliente\nasync setClientException(clienteId,exceptions){try{const{data:{user}}=await supabase.auth.getUser();const{data,error}=await supabase.from('email_exceptions').upsert(_objectSpread(_objectSpread({user_id:user.id,cliente_id:clienteId},exceptions),{},{created_at:new Date().toISOString()}),{onConflict:'user_id,cliente_id'}).select().single();if(error)throw error;return{data,error:null};}catch(error){console.error('Erro ao salvar exceção:',error);return{data:null,error:error.message};}},// Remover exceção de cliente\nasync removeClientException(clienteId){try{const{data:{user}}=await supabase.auth.getUser();const{error}=await supabase.from('email_exceptions').delete().eq('user_id',user.id).eq('cliente_id',clienteId);if(error)throw error;return{error:null};}catch(error){console.error('Erro ao remover exceção:',error);return{error:error.message};}},// Listar todas as exceções do usuário\nasync getAllExceptions(){try{const{data:{user}}=await supabase.auth.getUser();const{data,error}=await supabase.from('email_exceptions').select('*').eq('user_id',user.id).order('created_at',{ascending:false});if(error)throw error;return{data:data||[],error:null};}catch(error){console.error('Erro ao listar exceções:',error);return{data:[],error:error.message};}},// ==================== VERIFICAÇÕES ====================\n// Verificar se pode enviar email para cliente\nasync canSendEmailToClient(clienteId,tipoEmail){try{// 1. Buscar configurações globais\nconst{data:settings}=await this.getSettings();if(!settings){// Se não tem configurações, permite por padrão\nreturn{canSend:true,reason:null};}// 2. Verificar exceções do cliente\nconst{data:exception}=await this.getClientException(clienteId);// Se todos os emails estão desativados para este cliente\nif(exception!==null&&exception!==void 0&&exception.todos_emails_desativados){return{canSend:false,reason:\"Todos os emails desativados para este cliente\".concat(exception.motivo?': '+exception.motivo:'')};}// 3. Verificar cada tipo de email (Ajuste: Mapeamento de templates para os cases)\nlet tipoNormalizado=tipoEmail;if(tipoEmail.includes('cobranca')||tipoEmail.includes('atraso'))tipoNormalizado='cobranca_atraso';if(tipoEmail.includes('vencimento'))tipoNormalizado='lembrete_vencimento';switch(tipoNormalizado){case'lembrete_vencimento':if(!settings.lembrete_vencimento_ativo){return{canSend:false,reason:'Lembretes de vencimento desativados globalmente'};}if(exception!==null&&exception!==void 0&&exception.lembrete_vencimento_desativado){return{canSend:false,reason:'Lembrete desativado para este cliente'};}break;case'cobranca_atraso':if(!settings.cobranca_atraso_ativo){return{canSend:false,reason:'Cobranças de atraso desativadas globalmente'};}if(exception!==null&&exception!==void 0&&exception.cobranca_atraso_desativado){return{canSend:false,reason:'Cobrança desativada para este cliente'};}break;case'relatorio_semanal':if(!settings.relatorio_semanal_ativo){return{canSend:false,reason:'Relatórios semanais desativados globalmente'};}if(exception!==null&&exception!==void 0&&exception.relatorio_semanal_desativado){return{canSend:false,reason:'Cliente excluído do relatório semanal'};}break;default:return{canSend:true,reason:null};}return{canSend:true,reason:null};}catch(error){console.error('Erro ao verificar permissão de email:',error);// Em caso de erro, permitir envio (fail-safe)\nreturn{canSend:true,reason:null};}},// ==================== ESTATÍSTICAS ====================\n// Buscar estatísticas de configurações\nasync getStatistics(){try{const{data:{user}}=await supabase.auth.getUser();if(!user)return{data:null,error:'Usuário não autenticado'};// Buscar configurações\nconst{data:settings}=await this.getSettings();// Buscar exceções\nconst{data:exceptions}=await this.getAllExceptions();return{data:{settings:settings||null,totalExceptions:exceptions?exceptions.length:0,exceptions:exceptions||[]},error:null};}catch(error){console.error('Erro ao buscar estatísticas:',error);return{data:null,error:error.message};}}};export default emailSettingsService;","map":{"version":3,"names":["supabase","emailSettingsService","getSettings","data","user","auth","getUser","error","from","select","eq","id","single","code","newSettings","createError","insert","user_id","lembrete_vencimento_ativo","lembrete_dias_antecedencia","cobranca_atraso_ativo","relatorio_semanal_ativo","relatorio_dia_semana","horario_envio","console","message","updateSettings","settings","update","getClientException","clienteId","setClientException","exceptions","upsert","_objectSpread","cliente_id","created_at","Date","toISOString","onConflict","removeClientException","delete","getAllExceptions","order","ascending","canSendEmailToClient","tipoEmail","canSend","reason","exception","todos_emails_desativados","concat","motivo","tipoNormalizado","includes","lembrete_vencimento_desativado","cobranca_atraso_desativado","relatorio_semanal_desativado","getStatistics","totalExceptions","length"],"sources":["C:/Users/ResTIC16/Desktop/gest-o-financeira/src/services/emailSettingsService.js"],"sourcesContent":["// ============================================\r\n// SERVIÇO COMPLETO DE CONFIGURAÇÕES DE EMAIL\r\n// src/services/emailSettingsService.js\r\n// ============================================\r\n\r\nimport { supabase } from '../lib/supabaseClient';\r\n\r\nexport const emailSettingsService = {\r\n  // ==================== CONFIGURAÇÕES GLOBAIS ====================\r\n  \r\n  // Buscar configurações do usuário\r\n  async getSettings() {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      // Ajuste: Verificação de usuário para evitar erro de leitura de null\r\n      if (!user) return { data: null, error: 'Usuário não autenticado' };\r\n\r\n      let { data, error } = await supabase\r\n        .from('email_settings')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .single();\r\n\r\n      // Se não existir, criar configurações padrão\r\n      if (error && error.code === 'PGRST116') {\r\n        const { data: newSettings, error: createError } = await supabase\r\n          .from('email_settings')\r\n          .insert([\r\n            {\r\n              user_id: user.id,\r\n              lembrete_vencimento_ativo: true,\r\n              lembrete_dias_antecedencia: 3,\r\n              cobranca_atraso_ativo: true,\r\n              relatorio_semanal_ativo: true,\r\n              relatorio_dia_semana: 1,\r\n              horario_envio: '09:00:00'\r\n            }\r\n          ])\r\n          .select()\r\n          .single();\r\n\r\n        if (createError) throw createError;\r\n        return { data: newSettings, error: null };\r\n      }\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao buscar configurações:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  // Atualizar configurações\r\n  async updateSettings(settings) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_settings')\r\n        .update(settings)\r\n        .eq('user_id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao atualizar configurações:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  // ==================== EXCEÇÕES POR CLIENTE ====================\r\n\r\n  // Buscar exceção de um cliente específico\r\n  async getClientException(clienteId) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) return { data: null, error: null };\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_exceptions')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .eq('cliente_id', clienteId)\r\n        .single();\r\n\r\n      if (error && error.code === 'PGRST116') {\r\n        // Não existe exceção para este cliente\r\n        return { data: null, error: null };\r\n      }\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao buscar exceção do cliente:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  // Criar ou atualizar exceção de cliente\r\n  async setClientException(clienteId, exceptions) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_exceptions')\r\n        .upsert(\r\n          {\r\n            user_id: user.id,\r\n            cliente_id: clienteId,\r\n            ...exceptions,\r\n            created_at: new Date().toISOString()\r\n          },\r\n          {\r\n            onConflict: 'user_id,cliente_id'\r\n          }\r\n        )\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao salvar exceção:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  // Remover exceção de cliente\r\n  async removeClientException(clienteId) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { error } = await supabase\r\n        .from('email_exceptions')\r\n        .delete()\r\n        .eq('user_id', user.id)\r\n        .eq('cliente_id', clienteId);\r\n\r\n      if (error) throw error;\r\n      return { error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao remover exceção:', error);\r\n      return { error: error.message };\r\n    }\r\n  },\r\n\r\n  // Listar todas as exceções do usuário\r\n  async getAllExceptions() {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_exceptions')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return { data: data || [], error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao listar exceções:', error);\r\n      return { data: [], error: error.message };\r\n    }\r\n  },\r\n\r\n  // ==================== VERIFICAÇÕES ====================\r\n\r\n  // Verificar se pode enviar email para cliente\r\n  async canSendEmailToClient(clienteId, tipoEmail) {\r\n    try {\r\n      // 1. Buscar configurações globais\r\n      const { data: settings } = await this.getSettings();\r\n      \r\n      if (!settings) {\r\n        // Se não tem configurações, permite por padrão\r\n        return { canSend: true, reason: null };\r\n      }\r\n\r\n      // 2. Verificar exceções do cliente\r\n      const { data: exception } = await this.getClientException(clienteId);\r\n\r\n      // Se todos os emails estão desativados para este cliente\r\n      if (exception?.todos_emails_desativados) {\r\n        return { \r\n          canSend: false, \r\n          reason: `Todos os emails desativados para este cliente${exception.motivo ? ': ' + exception.motivo : ''}` \r\n        };\r\n      }\r\n\r\n      // 3. Verificar cada tipo de email (Ajuste: Mapeamento de templates para os cases)\r\n      let tipoNormalizado = tipoEmail;\r\n      if (tipoEmail.includes('cobranca') || tipoEmail.includes('atraso')) tipoNormalizado = 'cobranca_atraso';\r\n      if (tipoEmail.includes('vencimento')) tipoNormalizado = 'lembrete_vencimento';\r\n\r\n      switch (tipoNormalizado) {\r\n        case 'lembrete_vencimento':\r\n          if (!settings.lembrete_vencimento_ativo) {\r\n            return { canSend: false, reason: 'Lembretes de vencimento desativados globalmente' };\r\n          }\r\n          if (exception?.lembrete_vencimento_desativado) {\r\n            return { canSend: false, reason: 'Lembrete desativado para este cliente' };\r\n          }\r\n          break;\r\n\r\n        case 'cobranca_atraso':\r\n          if (!settings.cobranca_atraso_ativo) {\r\n            return { canSend: false, reason: 'Cobranças de atraso desativadas globalmente' };\r\n          }\r\n          if (exception?.cobranca_atraso_desativado) {\r\n            return { canSend: false, reason: 'Cobrança desativada para este cliente' };\r\n          }\r\n          break;\r\n\r\n        case 'relatorio_semanal':\r\n          if (!settings.relatorio_semanal_ativo) {\r\n            return { canSend: false, reason: 'Relatórios semanais desativados globalmente' };\r\n          }\r\n          if (exception?.relatorio_semanal_desativado) {\r\n            return { canSend: false, reason: 'Cliente excluído do relatório semanal' };\r\n          }\r\n          break;\r\n\r\n        default:\r\n          return { canSend: true, reason: null };\r\n      }\r\n\r\n      return { canSend: true, reason: null };\r\n    } catch (error) {\r\n      console.error('Erro ao verificar permissão de email:', error);\r\n      // Em caso de erro, permitir envio (fail-safe)\r\n      return { canSend: true, reason: null };\r\n    }\r\n  },\r\n\r\n  // ==================== ESTATÍSTICAS ====================\r\n\r\n  // Buscar estatísticas de configurações\r\n  async getStatistics() {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) return { data: null, error: 'Usuário não autenticado' };\r\n\r\n      // Buscar configurações\r\n      const { data: settings } = await this.getSettings();\r\n\r\n      // Buscar exceções\r\n      const { data: exceptions } = await this.getAllExceptions();\r\n\r\n      return {\r\n        data: {\r\n          settings: settings || null,\r\n          totalExceptions: exceptions ? exceptions.length : 0,\r\n          exceptions: exceptions || []\r\n        },\r\n        error: null\r\n      };\r\n    } catch (error) {\r\n      console.error('Erro ao buscar estatísticas:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  }\r\n};\r\n\r\nexport default emailSettingsService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}