{"ast":null,"code":"import { supabase } from '../lib/supabaseClient';\nexport const emailSettingsService = {\n  async getSettings() {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      let {\n        data,\n        error\n      } = await supabase.from('email_settings').select('*').eq('user_id', user.id).single();\n      if (error && error.code === 'PGRST116') {\n        const {\n          data: newSettings,\n          error: createError\n        } = await supabase.from('email_settings').insert([{\n          user_id: user.id,\n          lembrete_vencimento_ativo: true,\n          lembrete_dias_antecedencia: 3,\n          cobranca_atraso_ativo: true,\n          relatorio_semanal_ativo: true,\n          relatorio_dia_semana: 1,\n          horario_envio: '09:00:00'\n        }]).select().single();\n        if (createError) throw createError;\n        return {\n          data: newSettings,\n          error: null\n        };\n      }\n      if (error) throw error;\n      return {\n        data,\n        error: null\n      };\n    } catch (error) {\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  },\n  async updateSettings(settings) {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      const {\n        data,\n        error\n      } = await supabase.from('email_settings').update(settings).eq('user_id', user.id).select().single();\n      if (error) throw error;\n      return {\n        data,\n        error: null\n      };\n    } catch (error) {\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  },\n  async getClientException(clienteId) {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      const {\n        data,\n        error\n      } = await supabase.from('email_exceptions').select('*').eq('user_id', user.id).eq('cliente_id', clienteId).single();\n      if (error && error.code === 'PGRST116') {\n        return {\n          data: null,\n          error: null\n        };\n      }\n      if (error) throw error;\n      return {\n        data,\n        error: null\n      };\n    } catch (error) {\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  },\n  async setClientException(clienteId, exceptions) {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      const {\n        data,\n        error\n      } = await supabase.from('email_exceptions').upsert({\n        user_id: user.id,\n        cliente_id: clienteId,\n        ...exceptions\n      }, {\n        onConflict: 'user_id,cliente_id'\n      }).select().single();\n      if (error) throw error;\n      return {\n        data,\n        error: null\n      };\n    } catch (error) {\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  }\n};","map":{"version":3,"names":["supabase","emailSettingsService","getSettings","data","user","auth","getUser","error","from","select","eq","id","single","code","newSettings","createError","insert","user_id","lembrete_vencimento_ativo","lembrete_dias_antecedencia","cobranca_atraso_ativo","relatorio_semanal_ativo","relatorio_dia_semana","horario_envio","message","updateSettings","settings","update","getClientException","clienteId","setClientException","exceptions","upsert","cliente_id","onConflict"],"sources":["C:/Users/ResTIC16/Desktop/gest-o-financeira/src/services/emailSettingsService.js"],"sourcesContent":["import { supabase } from '../lib/supabaseClient';\r\n\r\nexport const emailSettingsService = {\r\n  async getSettings() {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      let { data, error } = await supabase\r\n        .from('email_settings')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .single();\r\n\r\n      if (error && error.code === 'PGRST116') {\r\n        const { data: newSettings, error: createError } = await supabase\r\n          .from('email_settings')\r\n          .insert([\r\n            {\r\n              user_id: user.id,\r\n              lembrete_vencimento_ativo: true,\r\n              lembrete_dias_antecedencia: 3,\r\n              cobranca_atraso_ativo: true,\r\n              relatorio_semanal_ativo: true,\r\n              relatorio_dia_semana: 1,\r\n              horario_envio: '09:00:00'\r\n            }\r\n          ])\r\n          .select()\r\n          .single();\r\n\r\n        if (createError) throw createError;\r\n        return { data: newSettings, error: null };\r\n      }\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  async updateSettings(settings) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_settings')\r\n        .update(settings)\r\n        .eq('user_id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  async getClientException(clienteId) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_exceptions')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .eq('cliente_id', clienteId)\r\n        .single();\r\n\r\n      if (error && error.code === 'PGRST116') {\r\n        return { data: null, error: null };\r\n      }\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  async setClientException(clienteId, exceptions) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_exceptions')\r\n        .upsert(\r\n          {\r\n            user_id: user.id,\r\n            cliente_id: clienteId,\r\n            ...exceptions\r\n          },\r\n          {\r\n            onConflict: 'user_id,cliente_id'\r\n          }\r\n        )\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      return { data: null, error: error.message };\r\n    }\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}