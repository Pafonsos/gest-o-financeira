{"ast":null,"code":"import axios from 'axios';\nconst API_BASE_URL = 'http://localhost:5000/api';\n\n// Configurar axios com configura√ß√µes otimizadas\nconst axiosInstance = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 30000,\n  // 30 segundos\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nconst emailService = {\n  sendBulkEmails: async emailData => {\n    try {\n      // Valida√ß√£o\n      if (!emailData.recipients || emailData.recipients.length === 0) {\n        throw new Error('Nenhum destinat√°rio fornecido');\n      }\n      if (!emailData.subject || !emailData.template) {\n        throw new Error('Assunto e template s√£o obrigat√≥rios');\n      }\n\n      // Limpar dados desnecess√°rios e otimizar\n      const cleanRecipients = emailData.recipients.map(r => ({\n        email: r.email,\n        nomeResponsavel: r.nomeResponsavel || 'Cliente',\n        nomeEmpresa: r.nomeEmpresa || 'Empresa',\n        cnpj: r.cnpj || '',\n        valorPendente: r.valorPendente || '0,00',\n        parcelasAtraso: r.parcelasAtraso || '0',\n        proximoVencimento: r.proximoVencimento || '',\n        linkPagamento: r.linkPagamento || '#'\n      }));\n      const payload = {\n        recipients: cleanRecipients,\n        subject: emailData.subject,\n        template: emailData.template\n      };\n\n      // Log para debug\n      const payloadSize = JSON.stringify(payload).length;\n      console.log('üì¶ Tamanho do payload:', payloadSize, 'bytes');\n      console.log('üìß Total de emails:', cleanRecipients.length);\n\n      // Enviar request\n      const response = await axiosInstance.post('/email/send-bulk', payload);\n      console.log('‚úÖ Resposta:', response.data);\n      return response.data;\n    } catch (error) {\n      var _error$response, _error$response2;\n      console.error('‚ùå Erro detalhado:', {\n        message: error.message,\n        response: (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data,\n        status: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status\n      });\n      if (error.response) {\n        var _error$response$data;\n        const status = error.response.status;\n        const message = ((_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message;\n        if (status === 431) {\n          throw new Error('Dados muito grandes. Tente enviar menos emails por vez (m√°x: 50)');\n        }\n        if (status === 429) {\n          throw new Error('Limite de emails excedido. Aguarde um momento.');\n        }\n        if (status === 413) {\n          throw new Error('Payload muito grande. Reduza a quantidade de emails.');\n        }\n        if (status === 400) {\n          throw new Error(message || 'Dados inv√°lidos');\n        }\n        throw new Error(message);\n      } else if (error.request) {\n        throw new Error('Servidor n√£o respondeu. Verifique se o backend est√° rodando.');\n      } else {\n        throw new Error(error.message);\n      }\n    }\n  },\n  sendSingleEmail: async emailData => {\n    try {\n      const response = await axiosInstance.post('/email/send', emailData);\n      return response.data;\n    } catch (error) {\n      console.error('Erro ao enviar email √∫nico:', error);\n      throw error;\n    }\n  },\n  getTemplates: async () => {\n    try {\n      const response = await axiosInstance.get('/email/templates');\n      return response.data;\n    } catch (error) {\n      console.error('Erro ao obter templates:', error);\n      throw error;\n    }\n  },\n  getStatistics: async () => {\n    try {\n      const response = await axiosInstance.get('/email/statistics');\n      return response.data;\n    } catch (error) {\n      console.error('Erro ao obter estat√≠sticas:', error);\n      throw error;\n    }\n  }\n};\nexport default emailService;","map":{"version":3,"names":["axios","API_BASE_URL","axiosInstance","create","baseURL","timeout","headers","emailService","sendBulkEmails","emailData","recipients","length","Error","subject","template","cleanRecipients","map","r","email","nomeResponsavel","nomeEmpresa","cnpj","valorPendente","parcelasAtraso","proximoVencimento","linkPagamento","payload","payloadSize","JSON","stringify","console","log","response","post","data","error","_error$response","_error$response2","message","status","_error$response$data","request","sendSingleEmail","getTemplates","get","getStatistics"],"sources":["C:/Users/ResTIC16/Desktop/gest-o-financeira/src/services/emailService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = 'http://localhost:5000/api';\r\n\r\n// Configurar axios com configura√ß√µes otimizadas\r\nconst axiosInstance = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  timeout: 30000, // 30 segundos\r\n  headers: {\r\n    'Content-Type': 'application/json'\r\n  }\r\n});\r\n\r\nconst emailService = {\r\n  sendBulkEmails: async (emailData) => {\r\n    try {\r\n      // Valida√ß√£o\r\n      if (!emailData.recipients || emailData.recipients.length === 0) {\r\n        throw new Error('Nenhum destinat√°rio fornecido');\r\n      }\r\n\r\n      if (!emailData.subject || !emailData.template) {\r\n        throw new Error('Assunto e template s√£o obrigat√≥rios');\r\n      }\r\n\r\n      // Limpar dados desnecess√°rios e otimizar\r\n      const cleanRecipients = emailData.recipients.map(r => ({\r\n        email: r.email,\r\n        nomeResponsavel: r.nomeResponsavel || 'Cliente',\r\n        nomeEmpresa: r.nomeEmpresa || 'Empresa',\r\n        cnpj: r.cnpj || '',\r\n        valorPendente: r.valorPendente || '0,00',\r\n        parcelasAtraso: r.parcelasAtraso || '0',\r\n        proximoVencimento: r.proximoVencimento || '',\r\n        linkPagamento: r.linkPagamento || '#'\r\n      }));\r\n\r\n      const payload = {\r\n        recipients: cleanRecipients,\r\n        subject: emailData.subject,\r\n        template: emailData.template\r\n      };\r\n\r\n      // Log para debug\r\n      const payloadSize = JSON.stringify(payload).length;\r\n      console.log('üì¶ Tamanho do payload:', payloadSize, 'bytes');\r\n      console.log('üìß Total de emails:', cleanRecipients.length);\r\n\r\n      // Enviar request\r\n      const response = await axiosInstance.post('/email/send-bulk', payload);\r\n      \r\n      console.log('‚úÖ Resposta:', response.data);\r\n      \r\n      return response.data;\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Erro detalhado:', {\r\n        message: error.message,\r\n        response: error.response?.data,\r\n        status: error.response?.status\r\n      });\r\n      \r\n      if (error.response) {\r\n        const status = error.response.status;\r\n        const message = error.response.data?.message || error.message;\r\n        \r\n        if (status === 431) {\r\n          throw new Error('Dados muito grandes. Tente enviar menos emails por vez (m√°x: 50)');\r\n        }\r\n        \r\n        if (status === 429) {\r\n          throw new Error('Limite de emails excedido. Aguarde um momento.');\r\n        }\r\n        \r\n        if (status === 413) {\r\n          throw new Error('Payload muito grande. Reduza a quantidade de emails.');\r\n        }\r\n\r\n        if (status === 400) {\r\n          throw new Error(message || 'Dados inv√°lidos');\r\n        }\r\n        \r\n        throw new Error(message);\r\n      } else if (error.request) {\r\n        throw new Error('Servidor n√£o respondeu. Verifique se o backend est√° rodando.');\r\n      } else {\r\n        throw new Error(error.message);\r\n      }\r\n    }\r\n  },\r\n\r\n  sendSingleEmail: async (emailData) => {\r\n    try {\r\n      const response = await axiosInstance.post('/email/send', emailData);\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Erro ao enviar email √∫nico:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  getTemplates: async () => {\r\n    try {\r\n      const response = await axiosInstance.get('/email/templates');\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Erro ao obter templates:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  getStatistics: async () => {\r\n    try {\r\n      const response = await axiosInstance.get('/email/statistics');\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Erro ao obter estat√≠sticas:', error);\r\n      throw error;\r\n    }\r\n  }\r\n};\r\n\r\nexport default emailService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}