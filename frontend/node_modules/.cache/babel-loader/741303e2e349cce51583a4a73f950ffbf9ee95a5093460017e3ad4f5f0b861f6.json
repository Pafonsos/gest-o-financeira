{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ResTIC16\\\\Desktop\\\\gest-o-financeira\\\\frontend\\\\src\\\\pages\\\\PipefyPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport PipefyIntegration from '../components/PipefyIntegration';\nimport ProfileMenu from '../components/ProfileMenu';\nimport '../pages/AdminPage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst parseMoedaParaNumero = valor => {\n  if (typeof valor === 'number') return valor;\n  if (!valor) return 0;\n  return parseFloat(valor.toString().replace(/\\./g, '').replace(',', '.')) || 0;\n};\nconst PipefyPage = () => {\n  _s();\n  const [clientes, setClientes] = useState([]);\n  useEffect(() => {\n    const dadosSalvos = localStorage.getItem('financial-manager-clientes');\n    if (dadosSalvos) {\n      try {\n        setClientes(JSON.parse(dadosSalvos));\n      } catch {\n        setClientes([]);\n      }\n    }\n  }, []);\n  const applyPipefyImport = (cards, fieldMap, pipeFields = []) => {\n    if (!Array.isArray(cards) || cards.length === 0) return;\n    const fieldLookup = Array.isArray(pipeFields) ? pipeFields : [];\n    const normalize = value => (value || '').toString().trim();\n    const getFieldValue = (fields, fieldIdOrName) => {\n      if (!fieldIdOrName) return '';\n      const fromPipe = fieldLookup.find(f => f.id === fieldIdOrName);\n      const candidates = [fieldIdOrName, fromPipe === null || fromPipe === void 0 ? void 0 : fromPipe.label, fromPipe === null || fromPipe === void 0 ? void 0 : fromPipe.id].filter(Boolean).map(v => String(v).toLowerCase());\n      const found = fields.find(f => candidates.includes(String(f.name || '').toLowerCase()));\n      return (found === null || found === void 0 ? void 0 : found.value) || '';\n    };\n    const imported = cards.map(card => {\n      const fields = Array.isArray(card.fields) ? card.fields : [];\n      const nomeEmpresa = normalize(getFieldValue(fields, fieldMap.nomeEmpresa)) || card.title || '';\n      const nomeResponsavel = normalize(getFieldValue(fields, fieldMap.nomeResponsavel));\n      const email = normalize(getFieldValue(fields, fieldMap.email));\n      const telefone = normalize(getFieldValue(fields, fieldMap.telefone));\n      const cnpj = normalize(getFieldValue(fields, fieldMap.cnpj));\n      const codigoContrato = normalize(getFieldValue(fields, fieldMap.codigoContrato));\n      const valorTotal = parseMoedaParaNumero(getFieldValue(fields, fieldMap.valorTotal));\n      const parcelas = parseInt(getFieldValue(fields, fieldMap.parcelas), 10) || 1;\n      const dataVenda = normalize(getFieldValue(fields, fieldMap.dataVenda));\n      const proximoVencimento = normalize(getFieldValue(fields, fieldMap.proximoVencimento));\n      const linkPagamento = normalize(getFieldValue(fields, fieldMap.linkPagamento));\n      const observacoes = normalize(getFieldValue(fields, fieldMap.observacoes));\n      return {\n        id: card.id,\n        nomeResponsavel,\n        nomeEmpresa,\n        email,\n        telefone,\n        valorTotal,\n        parcelas,\n        dataVenda,\n        proximoVencimento,\n        cnpj,\n        codigoContrato,\n        linkPagamento,\n        observacoes,\n        valorPago: 0,\n        parcelasPagas: 0,\n        historicosPagamentos: []\n      };\n    });\n    setClientes(prev => {\n      const updated = [...prev];\n      imported.forEach(cliente => {\n        const matchIndex = updated.findIndex(c => {\n          if (cliente.email && c.email === cliente.email) return true;\n          if (cliente.cnpj && c.cnpj === cliente.cnpj) return true;\n          if (cliente.codigoContrato && c.codigoContrato === cliente.codigoContrato) return true;\n          return false;\n        });\n        if (matchIndex >= 0) {\n          updated[matchIndex] = {\n            ...updated[matchIndex],\n            ...cliente\n          };\n        } else {\n          updated.push(cliente);\n        }\n      });\n      localStorage.setItem('financial-manager-clientes', JSON.stringify(updated));\n      return updated;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"admin-page\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"admin-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"admin-topbar\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/dashboard\",\n          className: \"admin-logo\",\n          \"aria-label\": \"Voltar ao in\\xEDcio\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/logo-proteq.png\",\n            alt: \"PROTEQ Logo\",\n            className: \"admin-logo-image\",\n            onError: e => e.target.style.display = 'none'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProfileMenu, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(PipefyIntegration, {\n        clientes: clientes,\n        onImportCards: applyPipefyImport\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }, this);\n};\n_s(PipefyPage, \"HULfgVUvabrDmHl/V3upbLnD830=\");\n_c = PipefyPage;\nexport default PipefyPage;\nvar _c;\n$RefreshReg$(_c, \"PipefyPage\");","map":{"version":3,"names":["React","useEffect","useState","Link","PipefyIntegration","ProfileMenu","jsxDEV","_jsxDEV","parseMoedaParaNumero","valor","parseFloat","toString","replace","PipefyPage","_s","clientes","setClientes","dadosSalvos","localStorage","getItem","JSON","parse","applyPipefyImport","cards","fieldMap","pipeFields","Array","isArray","length","fieldLookup","normalize","value","trim","getFieldValue","fields","fieldIdOrName","fromPipe","find","f","id","candidates","label","filter","Boolean","map","v","String","toLowerCase","found","includes","name","imported","card","nomeEmpresa","title","nomeResponsavel","email","telefone","cnpj","codigoContrato","valorTotal","parcelas","parseInt","dataVenda","proximoVencimento","linkPagamento","observacoes","valorPago","parcelasPagas","historicosPagamentos","prev","updated","forEach","cliente","matchIndex","findIndex","c","push","setItem","stringify","className","children","to","src","alt","onError","e","target","style","display","fileName","_jsxFileName","lineNumber","columnNumber","onImportCards","_c","$RefreshReg$"],"sources":["C:/Users/ResTIC16/Desktop/gest-o-financeira/frontend/src/pages/PipefyPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport PipefyIntegration from '../components/PipefyIntegration';\nimport ProfileMenu from '../components/ProfileMenu';\nimport '../pages/AdminPage.css';\n\nconst parseMoedaParaNumero = (valor) => {\n  if (typeof valor === 'number') return valor;\n  if (!valor) return 0;\n  return parseFloat(valor.toString().replace(/\\./g, '').replace(',', '.')) || 0;\n};\n\nconst PipefyPage = () => {\n  const [clientes, setClientes] = useState([]);\n\n  useEffect(() => {\n    const dadosSalvos = localStorage.getItem('financial-manager-clientes');\n    if (dadosSalvos) {\n      try {\n        setClientes(JSON.parse(dadosSalvos));\n      } catch {\n        setClientes([]);\n      }\n    }\n  }, []);\n\n  const applyPipefyImport = (cards, fieldMap, pipeFields = []) => {\n    if (!Array.isArray(cards) || cards.length === 0) return;\n\n    const fieldLookup = Array.isArray(pipeFields) ? pipeFields : [];\n    const normalize = (value) => (value || '').toString().trim();\n    const getFieldValue = (fields, fieldIdOrName) => {\n      if (!fieldIdOrName) return '';\n      const fromPipe = fieldLookup.find((f) => f.id === fieldIdOrName);\n      const candidates = [\n        fieldIdOrName,\n        fromPipe?.label,\n        fromPipe?.id\n      ]\n        .filter(Boolean)\n        .map((v) => String(v).toLowerCase());\n\n      const found = fields.find((f) => candidates.includes(String(f.name || '').toLowerCase()));\n      return found?.value || '';\n    };\n\n    const imported = cards.map((card) => {\n      const fields = Array.isArray(card.fields) ? card.fields : [];\n      const nomeEmpresa = normalize(getFieldValue(fields, fieldMap.nomeEmpresa)) || card.title || '';\n      const nomeResponsavel = normalize(getFieldValue(fields, fieldMap.nomeResponsavel));\n      const email = normalize(getFieldValue(fields, fieldMap.email));\n      const telefone = normalize(getFieldValue(fields, fieldMap.telefone));\n      const cnpj = normalize(getFieldValue(fields, fieldMap.cnpj));\n      const codigoContrato = normalize(getFieldValue(fields, fieldMap.codigoContrato));\n      const valorTotal = parseMoedaParaNumero(getFieldValue(fields, fieldMap.valorTotal));\n      const parcelas = parseInt(getFieldValue(fields, fieldMap.parcelas), 10) || 1;\n      const dataVenda = normalize(getFieldValue(fields, fieldMap.dataVenda));\n      const proximoVencimento = normalize(getFieldValue(fields, fieldMap.proximoVencimento));\n      const linkPagamento = normalize(getFieldValue(fields, fieldMap.linkPagamento));\n      const observacoes = normalize(getFieldValue(fields, fieldMap.observacoes));\n\n      return {\n        id: card.id,\n        nomeResponsavel,\n        nomeEmpresa,\n        email,\n        telefone,\n        valorTotal,\n        parcelas,\n        dataVenda,\n        proximoVencimento,\n        cnpj,\n        codigoContrato,\n        linkPagamento,\n        observacoes,\n        valorPago: 0,\n        parcelasPagas: 0,\n        historicosPagamentos: []\n      };\n    });\n\n    setClientes((prev) => {\n      const updated = [...prev];\n      imported.forEach((cliente) => {\n        const matchIndex = updated.findIndex((c) => {\n          if (cliente.email && c.email === cliente.email) return true;\n          if (cliente.cnpj && c.cnpj === cliente.cnpj) return true;\n          if (cliente.codigoContrato && c.codigoContrato === cliente.codigoContrato) return true;\n          return false;\n        });\n\n        if (matchIndex >= 0) {\n          updated[matchIndex] = { ...updated[matchIndex], ...cliente };\n        } else {\n          updated.push(cliente);\n        }\n      });\n      localStorage.setItem('financial-manager-clientes', JSON.stringify(updated));\n      return updated;\n    });\n  };\n\n  return (\n    <div className=\"admin-page\">\n      <div className=\"admin-container\">\n        <div className=\"admin-topbar\">\n          <Link to=\"/dashboard\" className=\"admin-logo\" aria-label=\"Voltar ao inÃ­cio\">\n            <img\n              src=\"/logo-proteq.png\"\n              alt=\"PROTEQ Logo\"\n              className=\"admin-logo-image\"\n              onError={(e) => (e.target.style.display = 'none')}\n            />\n          </Link>\n          <ProfileMenu />\n        </div>\n        <PipefyIntegration\n          clientes={clientes}\n          onImportCards={applyPipefyImport}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default PipefyPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}