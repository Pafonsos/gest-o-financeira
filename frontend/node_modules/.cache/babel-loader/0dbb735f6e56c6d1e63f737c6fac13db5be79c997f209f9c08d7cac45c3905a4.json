{"ast":null,"code":"// ============================================\n// SERVIÇO COMPLETO DE CONFIGURAÇÕES DE EMAIL\n// src/services/emailSettingsService.js\n// ============================================\n\nimport { supabase } from '../lib/supabaseClient';\nexport const emailSettingsService = {\n  // ==================== CONFIGURAÇÕES GLOBAIS ====================\n\n  // Buscar configurações do usuário\n  async getSettings() {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n\n      // Ajuste: Verificação de usuário para evitar erro de leitura de null\n      if (!user) return {\n        data: null,\n        error: 'Usuário não autenticado'\n      };\n      let {\n        data,\n        error\n      } = await supabase.from('email_settings').select('*').eq('user_id', user.id).single();\n\n      // Se não existir, criar configurações padrão\n      if (error && error.code === 'PGRST116') {\n        const {\n          data: newSettings,\n          error: createError\n        } = await supabase.from('email_settings').insert([{\n          user_id: user.id,\n          lembrete_vencimento_ativo: true,\n          lembrete_dias_antecedencia: 3,\n          cobranca_atraso_ativo: true,\n          relatorio_semanal_ativo: true,\n          relatorio_dia_semana: 1,\n          horario_envio: '09:00:00'\n        }]).select().single();\n        if (createError) throw createError;\n        return {\n          data: newSettings,\n          error: null\n        };\n      }\n      if (error) throw error;\n      return {\n        data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Erro ao buscar configurações:', error);\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  },\n  // Atualizar configurações\n  async updateSettings(settings) {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      const {\n        data,\n        error\n      } = await supabase.from('email_settings').update(settings).eq('user_id', user.id).select().single();\n      if (error) throw error;\n      return {\n        data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Erro ao atualizar configurações:', error);\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  },\n  // ==================== EXCEÇÕES POR CLIENTE ====================\n\n  // Buscar exceção de um cliente específico\n  async getClientException(clienteId) {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      if (!user) return {\n        data: null,\n        error: null\n      };\n      const {\n        data,\n        error\n      } = await supabase.from('email_exceptions').select('*').eq('user_id', user.id).eq('cliente_id', clienteId).single();\n      if (error && error.code === 'PGRST116') {\n        // Não existe exceção para este cliente\n        return {\n          data: null,\n          error: null\n        };\n      }\n      if (error) throw error;\n      return {\n        data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Erro ao buscar exceção do cliente:', error);\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  },\n  // Criar ou atualizar exceção de cliente\n  async setClientException(clienteId, exceptions) {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      const {\n        data,\n        error\n      } = await supabase.from('email_exceptions').upsert({\n        user_id: user.id,\n        cliente_id: clienteId,\n        ...exceptions,\n        created_at: new Date().toISOString()\n      }, {\n        onConflict: 'user_id,cliente_id'\n      }).select().single();\n      if (error) throw error;\n      return {\n        data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Erro ao salvar exceção:', error);\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  },\n  // Remover exceção de cliente\n  async removeClientException(clienteId) {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      const {\n        error\n      } = await supabase.from('email_exceptions').delete().eq('user_id', user.id).eq('cliente_id', clienteId);\n      if (error) throw error;\n      return {\n        error: null\n      };\n    } catch (error) {\n      console.error('Erro ao remover exceção:', error);\n      return {\n        error: error.message\n      };\n    }\n  },\n  // Listar todas as exceções do usuário\n  async getAllExceptions() {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      const {\n        data,\n        error\n      } = await supabase.from('email_exceptions').select('*').eq('user_id', user.id).order('created_at', {\n        ascending: false\n      });\n      if (error) throw error;\n      return {\n        data: data || [],\n        error: null\n      };\n    } catch (error) {\n      console.error('Erro ao listar exceções:', error);\n      return {\n        data: [],\n        error: error.message\n      };\n    }\n  },\n  // ==================== VERIFICAÇÕES ====================\n\n  // Verificar se pode enviar email para cliente\n  async canSendEmailToClient(clienteId, tipoEmail) {\n    try {\n      // 1. Buscar configurações globais\n      const {\n        data: settings\n      } = await this.getSettings();\n      if (!settings) {\n        // Se não tem configurações, permite por padrão\n        return {\n          canSend: true,\n          reason: null\n        };\n      }\n\n      // 2. Verificar exceções do cliente\n      const {\n        data: exception\n      } = await this.getClientException(clienteId);\n\n      // Se todos os emails estão desativados para este cliente\n      if (exception !== null && exception !== void 0 && exception.todos_emails_desativados) {\n        return {\n          canSend: false,\n          reason: `Todos os emails desativados para este cliente${exception.motivo ? ': ' + exception.motivo : ''}`\n        };\n      }\n\n      // 3. Verificar cada tipo de email (Ajuste: Mapeamento de templates para os cases)\n      let tipoNormalizado = tipoEmail;\n      if (tipoEmail.includes('cobranca') || tipoEmail.includes('atraso')) tipoNormalizado = 'cobranca_atraso';\n      if (tipoEmail.includes('vencimento')) tipoNormalizado = 'lembrete_vencimento';\n      switch (tipoNormalizado) {\n        case 'lembrete_vencimento':\n          if (!settings.lembrete_vencimento_ativo) {\n            return {\n              canSend: false,\n              reason: 'Lembretes de vencimento desativados globalmente'\n            };\n          }\n          if (exception !== null && exception !== void 0 && exception.lembrete_vencimento_desativado) {\n            return {\n              canSend: false,\n              reason: 'Lembrete desativado para este cliente'\n            };\n          }\n          break;\n        case 'cobranca_atraso':\n          if (!settings.cobranca_atraso_ativo) {\n            return {\n              canSend: false,\n              reason: 'Cobranças de atraso desativadas globalmente'\n            };\n          }\n          if (exception !== null && exception !== void 0 && exception.cobranca_atraso_desativado) {\n            return {\n              canSend: false,\n              reason: 'Cobrança desativada para este cliente'\n            };\n          }\n          break;\n        case 'relatorio_semanal':\n          if (!settings.relatorio_semanal_ativo) {\n            return {\n              canSend: false,\n              reason: 'Relatórios semanais desativados globalmente'\n            };\n          }\n          if (exception !== null && exception !== void 0 && exception.relatorio_semanal_desativado) {\n            return {\n              canSend: false,\n              reason: 'Cliente excluído do relatório semanal'\n            };\n          }\n          break;\n        default:\n          return {\n            canSend: true,\n            reason: null\n          };\n      }\n      return {\n        canSend: true,\n        reason: null\n      };\n    } catch (error) {\n      console.error('Erro ao verificar permissão de email:', error);\n      // Em caso de erro, permitir envio (fail-safe)\n      return {\n        canSend: true,\n        reason: null\n      };\n    }\n  },\n  // ==================== ESTATÍSTICAS ====================\n\n  // Buscar estatísticas de configurações\n  async getStatistics() {\n    try {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      if (!user) return {\n        data: null,\n        error: 'Usuário não autenticado'\n      };\n\n      // Buscar configurações\n      const {\n        data: settings\n      } = await this.getSettings();\n\n      // Buscar exceções\n      const {\n        data: exceptions\n      } = await this.getAllExceptions();\n      return {\n        data: {\n          settings: settings || null,\n          totalExceptions: exceptions ? exceptions.length : 0,\n          exceptions: exceptions || []\n        },\n        error: null\n      };\n    } catch (error) {\n      console.error('Erro ao buscar estatísticas:', error);\n      return {\n        data: null,\n        error: error.message\n      };\n    }\n  }\n};\nexport default emailSettingsService;","map":{"version":3,"names":["supabase","emailSettingsService","getSettings","data","user","auth","getUser","error","from","select","eq","id","single","code","newSettings","createError","insert","user_id","lembrete_vencimento_ativo","lembrete_dias_antecedencia","cobranca_atraso_ativo","relatorio_semanal_ativo","relatorio_dia_semana","horario_envio","console","message","updateSettings","settings","update","getClientException","clienteId","setClientException","exceptions","upsert","cliente_id","created_at","Date","toISOString","onConflict","removeClientException","delete","getAllExceptions","order","ascending","canSendEmailToClient","tipoEmail","canSend","reason","exception","todos_emails_desativados","motivo","tipoNormalizado","includes","lembrete_vencimento_desativado","cobranca_atraso_desativado","relatorio_semanal_desativado","getStatistics","totalExceptions","length"],"sources":["C:/Users/afonso/Desktop/faculdade/frontend/src/services/emailSettingsService.js"],"sourcesContent":["// ============================================\r\n// SERVIÇO COMPLETO DE CONFIGURAÇÕES DE EMAIL\r\n// src/services/emailSettingsService.js\r\n// ============================================\r\n\r\nimport { supabase } from '../lib/supabaseClient';\r\n\r\nexport const emailSettingsService = {\r\n  // ==================== CONFIGURAÇÕES GLOBAIS ====================\r\n  \r\n  // Buscar configurações do usuário\r\n  async getSettings() {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      // Ajuste: Verificação de usuário para evitar erro de leitura de null\r\n      if (!user) return { data: null, error: 'Usuário não autenticado' };\r\n\r\n      let { data, error } = await supabase\r\n        .from('email_settings')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .single();\r\n\r\n      // Se não existir, criar configurações padrão\r\n      if (error && error.code === 'PGRST116') {\r\n        const { data: newSettings, error: createError } = await supabase\r\n          .from('email_settings')\r\n          .insert([\r\n            {\r\n              user_id: user.id,\r\n              lembrete_vencimento_ativo: true,\r\n              lembrete_dias_antecedencia: 3,\r\n              cobranca_atraso_ativo: true,\r\n              relatorio_semanal_ativo: true,\r\n              relatorio_dia_semana: 1,\r\n              horario_envio: '09:00:00'\r\n            }\r\n          ])\r\n          .select()\r\n          .single();\r\n\r\n        if (createError) throw createError;\r\n        return { data: newSettings, error: null };\r\n      }\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao buscar configurações:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  // Atualizar configurações\r\n  async updateSettings(settings) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_settings')\r\n        .update(settings)\r\n        .eq('user_id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao atualizar configurações:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  // ==================== EXCEÇÕES POR CLIENTE ====================\r\n\r\n  // Buscar exceção de um cliente específico\r\n  async getClientException(clienteId) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) return { data: null, error: null };\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_exceptions')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .eq('cliente_id', clienteId)\r\n        .single();\r\n\r\n      if (error && error.code === 'PGRST116') {\r\n        // Não existe exceção para este cliente\r\n        return { data: null, error: null };\r\n      }\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao buscar exceção do cliente:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  // Criar ou atualizar exceção de cliente\r\n  async setClientException(clienteId, exceptions) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_exceptions')\r\n        .upsert(\r\n          {\r\n            user_id: user.id,\r\n            cliente_id: clienteId,\r\n            ...exceptions,\r\n            created_at: new Date().toISOString()\r\n          },\r\n          {\r\n            onConflict: 'user_id,cliente_id'\r\n          }\r\n        )\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return { data, error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao salvar exceção:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  },\r\n\r\n  // Remover exceção de cliente\r\n  async removeClientException(clienteId) {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { error } = await supabase\r\n        .from('email_exceptions')\r\n        .delete()\r\n        .eq('user_id', user.id)\r\n        .eq('cliente_id', clienteId);\r\n\r\n      if (error) throw error;\r\n      return { error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao remover exceção:', error);\r\n      return { error: error.message };\r\n    }\r\n  },\r\n\r\n  // Listar todas as exceções do usuário\r\n  async getAllExceptions() {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      const { data, error } = await supabase\r\n        .from('email_exceptions')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return { data: data || [], error: null };\r\n    } catch (error) {\r\n      console.error('Erro ao listar exceções:', error);\r\n      return { data: [], error: error.message };\r\n    }\r\n  },\r\n\r\n  // ==================== VERIFICAÇÕES ====================\r\n\r\n  // Verificar se pode enviar email para cliente\r\n  async canSendEmailToClient(clienteId, tipoEmail) {\r\n    try {\r\n      // 1. Buscar configurações globais\r\n      const { data: settings } = await this.getSettings();\r\n      \r\n      if (!settings) {\r\n        // Se não tem configurações, permite por padrão\r\n        return { canSend: true, reason: null };\r\n      }\r\n\r\n      // 2. Verificar exceções do cliente\r\n      const { data: exception } = await this.getClientException(clienteId);\r\n\r\n      // Se todos os emails estão desativados para este cliente\r\n      if (exception?.todos_emails_desativados) {\r\n        return { \r\n          canSend: false, \r\n          reason: `Todos os emails desativados para este cliente${exception.motivo ? ': ' + exception.motivo : ''}` \r\n        };\r\n      }\r\n\r\n      // 3. Verificar cada tipo de email (Ajuste: Mapeamento de templates para os cases)\r\n      let tipoNormalizado = tipoEmail;\r\n      if (tipoEmail.includes('cobranca') || tipoEmail.includes('atraso')) tipoNormalizado = 'cobranca_atraso';\r\n      if (tipoEmail.includes('vencimento')) tipoNormalizado = 'lembrete_vencimento';\r\n\r\n      switch (tipoNormalizado) {\r\n        case 'lembrete_vencimento':\r\n          if (!settings.lembrete_vencimento_ativo) {\r\n            return { canSend: false, reason: 'Lembretes de vencimento desativados globalmente' };\r\n          }\r\n          if (exception?.lembrete_vencimento_desativado) {\r\n            return { canSend: false, reason: 'Lembrete desativado para este cliente' };\r\n          }\r\n          break;\r\n\r\n        case 'cobranca_atraso':\r\n          if (!settings.cobranca_atraso_ativo) {\r\n            return { canSend: false, reason: 'Cobranças de atraso desativadas globalmente' };\r\n          }\r\n          if (exception?.cobranca_atraso_desativado) {\r\n            return { canSend: false, reason: 'Cobrança desativada para este cliente' };\r\n          }\r\n          break;\r\n\r\n        case 'relatorio_semanal':\r\n          if (!settings.relatorio_semanal_ativo) {\r\n            return { canSend: false, reason: 'Relatórios semanais desativados globalmente' };\r\n          }\r\n          if (exception?.relatorio_semanal_desativado) {\r\n            return { canSend: false, reason: 'Cliente excluído do relatório semanal' };\r\n          }\r\n          break;\r\n\r\n        default:\r\n          return { canSend: true, reason: null };\r\n      }\r\n\r\n      return { canSend: true, reason: null };\r\n    } catch (error) {\r\n      console.error('Erro ao verificar permissão de email:', error);\r\n      // Em caso de erro, permitir envio (fail-safe)\r\n      return { canSend: true, reason: null };\r\n    }\r\n  },\r\n\r\n  // ==================== ESTATÍSTICAS ====================\r\n\r\n  // Buscar estatísticas de configurações\r\n  async getStatistics() {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) return { data: null, error: 'Usuário não autenticado' };\r\n\r\n      // Buscar configurações\r\n      const { data: settings } = await this.getSettings();\r\n\r\n      // Buscar exceções\r\n      const { data: exceptions } = await this.getAllExceptions();\r\n\r\n      return {\r\n        data: {\r\n          settings: settings || null,\r\n          totalExceptions: exceptions ? exceptions.length : 0,\r\n          exceptions: exceptions || []\r\n        },\r\n        error: null\r\n      };\r\n    } catch (error) {\r\n      console.error('Erro ao buscar estatísticas:', error);\r\n      return { data: null, error: error.message };\r\n    }\r\n  }\r\n};\r\n\r\nexport default emailSettingsService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}