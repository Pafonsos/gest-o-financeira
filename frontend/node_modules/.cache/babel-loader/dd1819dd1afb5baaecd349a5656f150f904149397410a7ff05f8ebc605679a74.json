{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ResTIC16\\\\Desktop\\\\gest-o-financeira\\\\frontend\\\\src\\\\pages\\\\PipefyPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport PipefyIntegration from '../components/PipefyIntegration';\nimport ProfileMenu from '../components/ProfileMenu';\nimport '../pages/AdminPage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst parseMoedaParaNumero = valor => {\n  if (typeof valor === 'number') return valor;\n  if (!valor) return 0;\n  return parseFloat(valor.toString().replace(/\\./g, '').replace(',', '.')) || 0;\n};\nconst PipefyPage = () => {\n  _s();\n  const [clientes, setClientes] = useState([]);\n  useEffect(() => {\n    const dadosSalvos = localStorage.getItem('financial-manager-clientes');\n    if (dadosSalvos) {\n      try {\n        setClientes(JSON.parse(dadosSalvos));\n      } catch {\n        setClientes([]);\n      }\n    }\n  }, []);\n  const applyPipefyImport = (cards, fieldMap) => {\n    if (!Array.isArray(cards) || cards.length === 0) return;\n    const normalize = value => (value || '').toString().trim();\n    const getFieldValue = (fields, fieldIdOrName) => {\n      if (!fieldIdOrName) return '';\n      const foundById = fields.find(f => f.id === fieldIdOrName);\n      if ((foundById === null || foundById === void 0 ? void 0 : foundById.value) !== undefined) return foundById.value || '';\n      const foundByName = fields.find(f => (f.name || '').toLowerCase() === String(fieldIdOrName).toLowerCase());\n      return (foundByName === null || foundByName === void 0 ? void 0 : foundByName.value) || '';\n    };\n    const imported = cards.map(card => {\n      const fields = Array.isArray(card.fields) ? card.fields : [];\n      const nomeEmpresa = normalize(getFieldValue(fields, fieldMap.nomeEmpresa)) || card.title || '';\n      const nomeResponsavel = normalize(getFieldValue(fields, fieldMap.nomeResponsavel));\n      const email = normalize(getFieldValue(fields, fieldMap.email));\n      const telefone = normalize(getFieldValue(fields, fieldMap.telefone));\n      const cnpj = normalize(getFieldValue(fields, fieldMap.cnpj));\n      const codigoContrato = normalize(getFieldValue(fields, fieldMap.codigoContrato));\n      const valorTotal = parseMoedaParaNumero(getFieldValue(fields, fieldMap.valorTotal));\n      const parcelas = parseInt(getFieldValue(fields, fieldMap.parcelas), 10) || 1;\n      const dataVenda = normalize(getFieldValue(fields, fieldMap.dataVenda));\n      const proximoVencimento = normalize(getFieldValue(fields, fieldMap.proximoVencimento));\n      const linkPagamento = normalize(getFieldValue(fields, fieldMap.linkPagamento));\n      const observacoes = normalize(getFieldValue(fields, fieldMap.observacoes));\n      return {\n        id: card.id,\n        nomeResponsavel,\n        nomeEmpresa,\n        email,\n        telefone,\n        valorTotal,\n        parcelas,\n        dataVenda,\n        proximoVencimento,\n        cnpj,\n        codigoContrato,\n        linkPagamento,\n        observacoes,\n        valorPago: 0,\n        parcelasPagas: 0,\n        historicosPagamentos: []\n      };\n    });\n    setClientes(prev => {\n      const updated = [...prev];\n      imported.forEach(cliente => {\n        const matchIndex = updated.findIndex(c => {\n          if (cliente.email && c.email === cliente.email) return true;\n          if (cliente.cnpj && c.cnpj === cliente.cnpj) return true;\n          if (cliente.codigoContrato && c.codigoContrato === cliente.codigoContrato) return true;\n          return false;\n        });\n        if (matchIndex >= 0) {\n          updated[matchIndex] = {\n            ...updated[matchIndex],\n            ...cliente\n          };\n        } else {\n          updated.push(cliente);\n        }\n      });\n      localStorage.setItem('financial-manager-clientes', JSON.stringify(updated));\n      return updated;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"admin-page\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"admin-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"admin-topbar\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/dashboard\",\n          className: \"admin-logo\",\n          \"aria-label\": \"Voltar ao in\\xEDcio\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/logo-proteq.png\",\n            alt: \"PROTEQ Logo\",\n            className: \"admin-logo-image\",\n            onError: e => e.target.style.display = 'none'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProfileMenu, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(PipefyIntegration, {\n        clientes: clientes,\n        onImportCards: applyPipefyImport\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n};\n_s(PipefyPage, \"HULfgVUvabrDmHl/V3upbLnD830=\");\n_c = PipefyPage;\nexport default PipefyPage;\nvar _c;\n$RefreshReg$(_c, \"PipefyPage\");","map":{"version":3,"names":["React","useEffect","useState","Link","PipefyIntegration","ProfileMenu","jsxDEV","_jsxDEV","parseMoedaParaNumero","valor","parseFloat","toString","replace","PipefyPage","_s","clientes","setClientes","dadosSalvos","localStorage","getItem","JSON","parse","applyPipefyImport","cards","fieldMap","Array","isArray","length","normalize","value","trim","getFieldValue","fields","fieldIdOrName","foundById","find","f","id","undefined","foundByName","name","toLowerCase","String","imported","map","card","nomeEmpresa","title","nomeResponsavel","email","telefone","cnpj","codigoContrato","valorTotal","parcelas","parseInt","dataVenda","proximoVencimento","linkPagamento","observacoes","valorPago","parcelasPagas","historicosPagamentos","prev","updated","forEach","cliente","matchIndex","findIndex","c","push","setItem","stringify","className","children","to","src","alt","onError","e","target","style","display","fileName","_jsxFileName","lineNumber","columnNumber","onImportCards","_c","$RefreshReg$"],"sources":["C:/Users/ResTIC16/Desktop/gest-o-financeira/frontend/src/pages/PipefyPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport PipefyIntegration from '../components/PipefyIntegration';\nimport ProfileMenu from '../components/ProfileMenu';\nimport '../pages/AdminPage.css';\n\nconst parseMoedaParaNumero = (valor) => {\n  if (typeof valor === 'number') return valor;\n  if (!valor) return 0;\n  return parseFloat(valor.toString().replace(/\\./g, '').replace(',', '.')) || 0;\n};\n\nconst PipefyPage = () => {\n  const [clientes, setClientes] = useState([]);\n\n  useEffect(() => {\n    const dadosSalvos = localStorage.getItem('financial-manager-clientes');\n    if (dadosSalvos) {\n      try {\n        setClientes(JSON.parse(dadosSalvos));\n      } catch {\n        setClientes([]);\n      }\n    }\n  }, []);\n\n  const applyPipefyImport = (cards, fieldMap) => {\n    if (!Array.isArray(cards) || cards.length === 0) return;\n\n    const normalize = (value) => (value || '').toString().trim();\n    const getFieldValue = (fields, fieldIdOrName) => {\n      if (!fieldIdOrName) return '';\n      const foundById = fields.find((f) => f.id === fieldIdOrName);\n      if (foundById?.value !== undefined) return foundById.value || '';\n      const foundByName = fields.find((f) => (f.name || '').toLowerCase() === String(fieldIdOrName).toLowerCase());\n      return foundByName?.value || '';\n    };\n\n    const imported = cards.map((card) => {\n      const fields = Array.isArray(card.fields) ? card.fields : [];\n      const nomeEmpresa = normalize(getFieldValue(fields, fieldMap.nomeEmpresa)) || card.title || '';\n      const nomeResponsavel = normalize(getFieldValue(fields, fieldMap.nomeResponsavel));\n      const email = normalize(getFieldValue(fields, fieldMap.email));\n      const telefone = normalize(getFieldValue(fields, fieldMap.telefone));\n      const cnpj = normalize(getFieldValue(fields, fieldMap.cnpj));\n      const codigoContrato = normalize(getFieldValue(fields, fieldMap.codigoContrato));\n      const valorTotal = parseMoedaParaNumero(getFieldValue(fields, fieldMap.valorTotal));\n      const parcelas = parseInt(getFieldValue(fields, fieldMap.parcelas), 10) || 1;\n      const dataVenda = normalize(getFieldValue(fields, fieldMap.dataVenda));\n      const proximoVencimento = normalize(getFieldValue(fields, fieldMap.proximoVencimento));\n      const linkPagamento = normalize(getFieldValue(fields, fieldMap.linkPagamento));\n      const observacoes = normalize(getFieldValue(fields, fieldMap.observacoes));\n\n      return {\n        id: card.id,\n        nomeResponsavel,\n        nomeEmpresa,\n        email,\n        telefone,\n        valorTotal,\n        parcelas,\n        dataVenda,\n        proximoVencimento,\n        cnpj,\n        codigoContrato,\n        linkPagamento,\n        observacoes,\n        valorPago: 0,\n        parcelasPagas: 0,\n        historicosPagamentos: []\n      };\n    });\n\n    setClientes((prev) => {\n      const updated = [...prev];\n      imported.forEach((cliente) => {\n        const matchIndex = updated.findIndex((c) => {\n          if (cliente.email && c.email === cliente.email) return true;\n          if (cliente.cnpj && c.cnpj === cliente.cnpj) return true;\n          if (cliente.codigoContrato && c.codigoContrato === cliente.codigoContrato) return true;\n          return false;\n        });\n\n        if (matchIndex >= 0) {\n          updated[matchIndex] = { ...updated[matchIndex], ...cliente };\n        } else {\n          updated.push(cliente);\n        }\n      });\n      localStorage.setItem('financial-manager-clientes', JSON.stringify(updated));\n      return updated;\n    });\n  };\n\n  return (\n    <div className=\"admin-page\">\n      <div className=\"admin-container\">\n        <div className=\"admin-topbar\">\n          <Link to=\"/dashboard\" className=\"admin-logo\" aria-label=\"Voltar ao inÃ­cio\">\n            <img\n              src=\"/logo-proteq.png\"\n              alt=\"PROTEQ Logo\"\n              className=\"admin-logo-image\"\n              onError={(e) => (e.target.style.display = 'none')}\n            />\n          </Link>\n          <ProfileMenu />\n        </div>\n        <PipefyIntegration\n          clientes={clientes}\n          onImportCards={applyPipefyImport}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default PipefyPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}