{"ast":null,"code":"import axios from 'axios';\nimport { supabase } from '../lib/supabaseClient';\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\nconst axiosInstance = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 30000,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nconst withAuthHeaders = async () => {\n  const {\n    data: {\n      session\n    }\n  } = await supabase.auth.getSession();\n  const token = session === null || session === void 0 ? void 0 : session.access_token;\n  if (!token) {\n    throw new Error('Usuário não autenticado');\n  }\n  return {\n    Authorization: `Bearer ${token}`\n  };\n};\nconst pipefyService = {\n  testConnection: async apiToken => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/test', {\n      apiToken\n    }, {\n      headers\n    });\n    return response.data;\n  },\n  getPipeFields: async (pipeId, apiToken) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/pipe-fields', {\n      pipeId,\n      apiToken\n    }, {\n      headers\n    });\n    return response.data;\n  },\n  pushClients: async ({\n    pipeId,\n    clients,\n    fieldMap,\n    apiToken\n  }) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/push-clients', {\n      pipeId,\n      clients,\n      fieldMap,\n      apiToken\n    }, {\n      headers\n    });\n    return response.data;\n  },\n  pullCards: async ({\n    pipeId,\n    limit,\n    apiToken\n  }) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/pull-cards', {\n      pipeId,\n      limit,\n      apiToken\n    }, {\n      headers\n    });\n    return response.data;\n  },\n  moveCard: async ({\n    cardId,\n    phaseId,\n    apiToken\n  }) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/move-card', {\n      cardId,\n      phaseId,\n      apiToken\n    }, {\n      headers\n    });\n    return response.data;\n  }\n};\nexport default pipefyService;","map":{"version":3,"names":["axios","supabase","API_BASE_URL","process","env","REACT_APP_API_URL","axiosInstance","create","baseURL","timeout","headers","withAuthHeaders","data","session","auth","getSession","token","access_token","Error","Authorization","pipefyService","testConnection","apiToken","response","post","getPipeFields","pipeId","pushClients","clients","fieldMap","pullCards","limit","moveCard","cardId","phaseId"],"sources":["C:/Users/ResTIC16/Desktop/gest-o-financeira/frontend/src/services/pipefyService.js"],"sourcesContent":["import axios from 'axios';\nimport { supabase } from '../lib/supabaseClient';\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n\nconst axiosInstance = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 30000,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\nconst withAuthHeaders = async () => {\n  const { data: { session } } = await supabase.auth.getSession();\n  const token = session?.access_token;\n  if (!token) {\n    throw new Error('Usuário não autenticado');\n  }\n  return {\n    Authorization: `Bearer ${token}`\n  };\n};\n\nconst pipefyService = {\n  testConnection: async (apiToken) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/test', { apiToken }, { headers });\n    return response.data;\n  },\n\n  getPipeFields: async (pipeId, apiToken) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/pipe-fields', { pipeId, apiToken }, { headers });\n    return response.data;\n  },\n\n  pushClients: async ({ pipeId, clients, fieldMap, apiToken }) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post(\n      '/pipefy/push-clients',\n      { pipeId, clients, fieldMap, apiToken },\n      { headers }\n    );\n    return response.data;\n  },\n\n  pullCards: async ({ pipeId, limit, apiToken }) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/pull-cards', { pipeId, limit, apiToken }, { headers });\n    return response.data;\n  },\n\n  moveCard: async ({ cardId, phaseId, apiToken }) => {\n    const headers = await withAuthHeaders();\n    const response = await axiosInstance.post('/pipefy/move-card', { cardId, phaseId, apiToken }, { headers });\n    return response.data;\n  }\n};\n\nexport default pipefyService;\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,QAAQ,uBAAuB;AAEhD,MAAMC,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,2BAA2B;AAEjF,MAAMC,aAAa,GAAGN,KAAK,CAACO,MAAM,CAAC;EACjCC,OAAO,EAAEN,YAAY;EACrBO,OAAO,EAAE,KAAK;EACdC,OAAO,EAAE;IACP,cAAc,EAAE;EAClB;AACF,CAAC,CAAC;AAEF,MAAMC,eAAe,GAAG,MAAAA,CAAA,KAAY;EAClC,MAAM;IAAEC,IAAI,EAAE;MAAEC;IAAQ;EAAE,CAAC,GAAG,MAAMZ,QAAQ,CAACa,IAAI,CAACC,UAAU,CAAC,CAAC;EAC9D,MAAMC,KAAK,GAAGH,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEI,YAAY;EACnC,IAAI,CAACD,KAAK,EAAE;IACV,MAAM,IAAIE,KAAK,CAAC,yBAAyB,CAAC;EAC5C;EACA,OAAO;IACLC,aAAa,EAAE,UAAUH,KAAK;EAChC,CAAC;AACH,CAAC;AAED,MAAMI,aAAa,GAAG;EACpBC,cAAc,EAAE,MAAOC,QAAQ,IAAK;IAClC,MAAMZ,OAAO,GAAG,MAAMC,eAAe,CAAC,CAAC;IACvC,MAAMY,QAAQ,GAAG,MAAMjB,aAAa,CAACkB,IAAI,CAAC,cAAc,EAAE;MAAEF;IAAS,CAAC,EAAE;MAAEZ;IAAQ,CAAC,CAAC;IACpF,OAAOa,QAAQ,CAACX,IAAI;EACtB,CAAC;EAEDa,aAAa,EAAE,MAAAA,CAAOC,MAAM,EAAEJ,QAAQ,KAAK;IACzC,MAAMZ,OAAO,GAAG,MAAMC,eAAe,CAAC,CAAC;IACvC,MAAMY,QAAQ,GAAG,MAAMjB,aAAa,CAACkB,IAAI,CAAC,qBAAqB,EAAE;MAAEE,MAAM;MAAEJ;IAAS,CAAC,EAAE;MAAEZ;IAAQ,CAAC,CAAC;IACnG,OAAOa,QAAQ,CAACX,IAAI;EACtB,CAAC;EAEDe,WAAW,EAAE,MAAAA,CAAO;IAAED,MAAM;IAAEE,OAAO;IAAEC,QAAQ;IAAEP;EAAS,CAAC,KAAK;IAC9D,MAAMZ,OAAO,GAAG,MAAMC,eAAe,CAAC,CAAC;IACvC,MAAMY,QAAQ,GAAG,MAAMjB,aAAa,CAACkB,IAAI,CACvC,sBAAsB,EACtB;MAAEE,MAAM;MAAEE,OAAO;MAAEC,QAAQ;MAAEP;IAAS,CAAC,EACvC;MAAEZ;IAAQ,CACZ,CAAC;IACD,OAAOa,QAAQ,CAACX,IAAI;EACtB,CAAC;EAEDkB,SAAS,EAAE,MAAAA,CAAO;IAAEJ,MAAM;IAAEK,KAAK;IAAET;EAAS,CAAC,KAAK;IAChD,MAAMZ,OAAO,GAAG,MAAMC,eAAe,CAAC,CAAC;IACvC,MAAMY,QAAQ,GAAG,MAAMjB,aAAa,CAACkB,IAAI,CAAC,oBAAoB,EAAE;MAAEE,MAAM;MAAEK,KAAK;MAAET;IAAS,CAAC,EAAE;MAAEZ;IAAQ,CAAC,CAAC;IACzG,OAAOa,QAAQ,CAACX,IAAI;EACtB,CAAC;EAEDoB,QAAQ,EAAE,MAAAA,CAAO;IAAEC,MAAM;IAAEC,OAAO;IAAEZ;EAAS,CAAC,KAAK;IACjD,MAAMZ,OAAO,GAAG,MAAMC,eAAe,CAAC,CAAC;IACvC,MAAMY,QAAQ,GAAG,MAAMjB,aAAa,CAACkB,IAAI,CAAC,mBAAmB,EAAE;MAAES,MAAM;MAAEC,OAAO;MAAEZ;IAAS,CAAC,EAAE;MAAEZ;IAAQ,CAAC,CAAC;IAC1G,OAAOa,QAAQ,CAACX,IAAI;EACtB;AACF,CAAC;AAED,eAAeQ,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}