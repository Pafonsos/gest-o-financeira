{"ast":null,"code":"/**\r\n * Utilities for creating WebSocket instances across runtimes.\r\n */\nexport class WebSocketFactory {\n  /**\r\n   * Static-only utility – prevent instantiation.\r\n   */\n  constructor() {}\n  static detectEnvironment() {\n    var _a;\n    if (typeof WebSocket !== 'undefined') {\n      return {\n        type: 'native',\n        constructor: WebSocket\n      };\n    }\n    if (typeof globalThis !== 'undefined' && typeof globalThis.WebSocket !== 'undefined') {\n      return {\n        type: 'native',\n        constructor: globalThis.WebSocket\n      };\n    }\n    if (typeof global !== 'undefined' && typeof global.WebSocket !== 'undefined') {\n      return {\n        type: 'native',\n        constructor: global.WebSocket\n      };\n    }\n    if (typeof globalThis !== 'undefined' && typeof globalThis.WebSocketPair !== 'undefined' && typeof globalThis.WebSocket === 'undefined') {\n      return {\n        type: 'cloudflare',\n        error: 'Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.',\n        workaround: 'Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime.'\n      };\n    }\n    if (typeof globalThis !== 'undefined' && globalThis.EdgeRuntime || typeof navigator !== 'undefined' && ((_a = navigator.userAgent) === null || _a === void 0 ? void 0 : _a.includes('Vercel-Edge'))) {\n      return {\n        type: 'unsupported',\n        error: 'Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.',\n        workaround: 'Use serverless functions or a different deployment target for WebSocket functionality.'\n      };\n    }\n    // Use dynamic property access to avoid Next.js Edge Runtime static analysis warnings\n    const _process = globalThis['process'];\n    if (_process) {\n      const processVersions = _process['versions'];\n      if (processVersions && processVersions['node']) {\n        // Remove 'v' prefix if present and parse the major version\n        const versionString = processVersions['node'];\n        const nodeVersion = parseInt(versionString.replace(/^v/, '').split('.')[0]);\n        // Node.js 22+ should have native WebSocket\n        if (nodeVersion >= 22) {\n          // Check if native WebSocket is available (should be in Node.js 22+)\n          if (typeof globalThis.WebSocket !== 'undefined') {\n            return {\n              type: 'native',\n              constructor: globalThis.WebSocket\n            };\n          }\n          // If not available, user needs to provide it\n          return {\n            type: 'unsupported',\n            error: `Node.js ${nodeVersion} detected but native WebSocket not found.`,\n            workaround: 'Provide a WebSocket implementation via the transport option.'\n          };\n        }\n        // Node.js < 22 doesn't have native WebSocket\n        return {\n          type: 'unsupported',\n          error: `Node.js ${nodeVersion} detected without native WebSocket support.`,\n          workaround: 'For Node.js < 22, install \"ws\" package and provide it via the transport option:\\n' + 'import ws from \"ws\"\\n' + 'new RealtimeClient(url, { transport: ws })'\n        };\n      }\n    }\n    return {\n      type: 'unsupported',\n      error: 'Unknown JavaScript runtime without WebSocket support.',\n      workaround: \"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation.\"\n    };\n  }\n  /**\r\n   * Returns the best available WebSocket constructor for the current runtime.\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * const WS = WebSocketFactory.getWebSocketConstructor()\r\n   * const socket = new WS('wss://realtime.supabase.co/socket')\r\n   * ```\r\n   */\n  static getWebSocketConstructor() {\n    const env = this.detectEnvironment();\n    if (env.constructor) {\n      return env.constructor;\n    }\n    let errorMessage = env.error || 'WebSocket not supported in this environment.';\n    if (env.workaround) {\n      errorMessage += `\\n\\nSuggested solution: ${env.workaround}`;\n    }\n    throw new Error(errorMessage);\n  }\n  /**\r\n   * Creates a WebSocket using the detected constructor.\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * const socket = WebSocketFactory.createWebSocket('wss://realtime.supabase.co/socket')\r\n   * ```\r\n   */\n  static createWebSocket(url, protocols) {\n    const WS = this.getWebSocketConstructor();\n    return new WS(url, protocols);\n  }\n  /**\r\n   * Detects whether the runtime can establish WebSocket connections.\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * if (!WebSocketFactory.isWebSocketSupported()) {\r\n   *   console.warn('Falling back to long polling')\r\n   * }\r\n   * ```\r\n   */\n  static isWebSocketSupported() {\n    try {\n      const env = this.detectEnvironment();\n      return env.type === 'native' || env.type === 'ws';\n    } catch (_a) {\n      return false;\n    }\n  }\n}\nexport default WebSocketFactory;","map":{"version":3,"names":["WebSocketFactory","constructor","detectEnvironment","WebSocket","type","globalThis","global","WebSocketPair","error","workaround","EdgeRuntime","navigator","_a","userAgent","includes","_process","processVersions","versionString","nodeVersion","parseInt","replace","split","getWebSocketConstructor","env","errorMessage","Error","createWebSocket","url","protocols","WS","isWebSocketSupported"],"sources":["C:\\Users\\ResTIC16\\Desktop\\gest-o-financeira\\frontend\\node_modules\\@supabase\\realtime-js\\src\\lib\\websocket-factory.ts"],"sourcesContent":["export interface WebSocketLike {\r\n  readonly CONNECTING: number\r\n  readonly OPEN: number\r\n  readonly CLOSING: number\r\n  readonly CLOSED: number\r\n  readonly readyState: number\r\n  readonly url: string\r\n  readonly protocol: string\r\n\r\n  /**\r\n   * Closes the socket, optionally providing a close code and reason.\r\n   */\r\n  close(code?: number, reason?: string): void\r\n  /**\r\n   * Sends data through the socket using the underlying implementation.\r\n   */\r\n  send(data: string | ArrayBufferLike | Blob | ArrayBufferView): void\r\n\r\n  onopen: ((this: any, ev: Event) => any) | null\r\n  onmessage: ((this: any, ev: MessageEvent) => any) | null\r\n  onclose: ((this: any, ev: CloseEvent) => any) | null\r\n  onerror: ((this: any, ev: Event) => any) | null\r\n\r\n  /**\r\n   * Registers an event listener on the socket (compatible with browser WebSocket API).\r\n   */\r\n  addEventListener(type: string, listener: EventListener): void\r\n  /**\r\n   * Removes a previously registered event listener.\r\n   */\r\n  removeEventListener(type: string, listener: EventListener): void\r\n\r\n  // Add additional properties that may exist on WebSocket implementations\r\n  binaryType?: string\r\n  bufferedAmount?: number\r\n  extensions?: string\r\n  dispatchEvent?: (event: Event) => boolean\r\n}\r\n\r\nexport interface WebSocketEnvironment {\r\n  type: 'native' | 'ws' | 'cloudflare' | 'unsupported'\r\n  constructor?: any\r\n  error?: string\r\n  workaround?: string\r\n}\r\n\r\n/**\r\n * Utilities for creating WebSocket instances across runtimes.\r\n */\r\nexport class WebSocketFactory {\r\n  /**\r\n   * Static-only utility – prevent instantiation.\r\n   */\r\n  private constructor() {}\r\n  private static detectEnvironment(): WebSocketEnvironment {\r\n    if (typeof WebSocket !== 'undefined') {\r\n      return { type: 'native', constructor: WebSocket }\r\n    }\r\n\r\n    if (typeof globalThis !== 'undefined' && typeof (globalThis as any).WebSocket !== 'undefined') {\r\n      return { type: 'native', constructor: (globalThis as any).WebSocket }\r\n    }\r\n\r\n    if (typeof global !== 'undefined' && typeof (global as any).WebSocket !== 'undefined') {\r\n      return { type: 'native', constructor: (global as any).WebSocket }\r\n    }\r\n\r\n    if (\r\n      typeof globalThis !== 'undefined' &&\r\n      typeof (globalThis as any).WebSocketPair !== 'undefined' &&\r\n      typeof globalThis.WebSocket === 'undefined'\r\n    ) {\r\n      return {\r\n        type: 'cloudflare',\r\n        error:\r\n          'Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.',\r\n        workaround:\r\n          'Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime.',\r\n      }\r\n    }\r\n\r\n    if (\r\n      (typeof globalThis !== 'undefined' && (globalThis as any).EdgeRuntime) ||\r\n      (typeof navigator !== 'undefined' && navigator.userAgent?.includes('Vercel-Edge'))\r\n    ) {\r\n      return {\r\n        type: 'unsupported',\r\n        error:\r\n          'Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.',\r\n        workaround:\r\n          'Use serverless functions or a different deployment target for WebSocket functionality.',\r\n      }\r\n    }\r\n\r\n    // Use dynamic property access to avoid Next.js Edge Runtime static analysis warnings\r\n    const _process = (globalThis as any)['process']\r\n    if (_process) {\r\n      const processVersions = _process['versions']\r\n      if (processVersions && processVersions['node']) {\r\n        // Remove 'v' prefix if present and parse the major version\r\n        const versionString = processVersions['node']\r\n        const nodeVersion = parseInt(versionString.replace(/^v/, '').split('.')[0])\r\n\r\n        // Node.js 22+ should have native WebSocket\r\n        if (nodeVersion >= 22) {\r\n          // Check if native WebSocket is available (should be in Node.js 22+)\r\n          if (typeof globalThis.WebSocket !== 'undefined') {\r\n            return { type: 'native', constructor: globalThis.WebSocket }\r\n          }\r\n          // If not available, user needs to provide it\r\n          return {\r\n            type: 'unsupported',\r\n            error: `Node.js ${nodeVersion} detected but native WebSocket not found.`,\r\n            workaround: 'Provide a WebSocket implementation via the transport option.',\r\n          }\r\n        }\r\n\r\n        // Node.js < 22 doesn't have native WebSocket\r\n        return {\r\n          type: 'unsupported',\r\n          error: `Node.js ${nodeVersion} detected without native WebSocket support.`,\r\n          workaround:\r\n            'For Node.js < 22, install \"ws\" package and provide it via the transport option:\\n' +\r\n            'import ws from \"ws\"\\n' +\r\n            'new RealtimeClient(url, { transport: ws })',\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      type: 'unsupported',\r\n      error: 'Unknown JavaScript runtime without WebSocket support.',\r\n      workaround:\r\n        \"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation.\",\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns the best available WebSocket constructor for the current runtime.\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * const WS = WebSocketFactory.getWebSocketConstructor()\r\n   * const socket = new WS('wss://realtime.supabase.co/socket')\r\n   * ```\r\n   */\r\n  public static getWebSocketConstructor(): typeof WebSocket {\r\n    const env = this.detectEnvironment()\r\n    if (env.constructor) {\r\n      return env.constructor\r\n    }\r\n    let errorMessage = env.error || 'WebSocket not supported in this environment.'\r\n    if (env.workaround) {\r\n      errorMessage += `\\n\\nSuggested solution: ${env.workaround}`\r\n    }\r\n    throw new Error(errorMessage)\r\n  }\r\n\r\n  /**\r\n   * Creates a WebSocket using the detected constructor.\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * const socket = WebSocketFactory.createWebSocket('wss://realtime.supabase.co/socket')\r\n   * ```\r\n   */\r\n  public static createWebSocket(url: string | URL, protocols?: string | string[]): WebSocketLike {\r\n    const WS = this.getWebSocketConstructor()\r\n    return new WS(url, protocols)\r\n  }\r\n\r\n  /**\r\n   * Detects whether the runtime can establish WebSocket connections.\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * if (!WebSocketFactory.isWebSocketSupported()) {\r\n   *   console.warn('Falling back to long polling')\r\n   * }\r\n   * ```\r\n   */\r\n  public static isWebSocketSupported(): boolean {\r\n    try {\r\n      const env = this.detectEnvironment()\r\n      return env.type === 'native' || env.type === 'ws'\r\n    } catch {\r\n      return false\r\n    }\r\n  }\r\n}\r\n\r\nexport default WebSocketFactory\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}