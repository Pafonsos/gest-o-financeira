{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ResTIC16\\\\Desktop\\\\gest-o-financeira\\\\frontend\\\\src\\\\pages\\\\ChatPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { MessageCircle, Plus, Users, X, Send, Paperclip } from 'lucide-react';\nimport { supabase } from '../lib/supabaseClient';\nimport { useAuth } from '../contexts/AuthContext';\nimport ProfileMenu from '../components/ProfileMenu';\nimport '../pages/AdminPage.css';\nimport './ChatPage.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ChatPage = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [rooms, setRooms] = useState([]);\n  const [activeRoom, setActiveRoom] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [members, setMembers] = useState([]);\n  const [profiles, setProfiles] = useState([]);\n  const [messageText, setMessageText] = useState('');\n  const [attachment, setAttachment] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [status, setStatus] = useState('');\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [showMembersModal, setShowMembersModal] = useState(false);\n  const [newRoomName, setNewRoomName] = useState('');\n  const [selectedMemberIds, setSelectedMemberIds] = useState([]);\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const profileLookup = useMemo(() => {\n    const map = new Map();\n    profiles.forEach(p => {\n      if (p !== null && p !== void 0 && p.id) map.set(p.id, p);\n    });\n    return map;\n  }, [profiles]);\n  const memberMap = useMemo(() => {\n    const map = new Map();\n    members.forEach(m => {\n      if (m.userId) {\n        map.set(m.userId, m.profile || profileLookup.get(m.userId) || null);\n      }\n    });\n    return map;\n  }, [members, profileLookup]);\n  useEffect(() => {\n    const loadProfiles = async () => {\n      const {\n        data\n      } = await supabase.from('profiles').select('id, nome, email, foto_url, avatar_url');\n      setProfiles(data || []);\n    };\n    loadProfiles();\n  }, []);\n  useEffect(() => {\n    const loadRooms = async () => {\n      if (!(user !== null && user !== void 0 && user.id)) return;\n      setLoading(true);\n      const {\n        data,\n        error\n      } = await supabase.from('chat_room_members').select('room_id, role, chat_rooms(id, name, created_by, created_at)').eq('user_id', user.id);\n      if (error) {\n        setStatus('Erro ao carregar salas.');\n        setLoading(false);\n        return;\n      }\n      const mapped = (data || []).map(item => {\n        var _item$chat_rooms, _item$chat_rooms2, _item$chat_rooms3, _item$chat_rooms4;\n        return {\n          id: (_item$chat_rooms = item.chat_rooms) === null || _item$chat_rooms === void 0 ? void 0 : _item$chat_rooms.id,\n          name: (_item$chat_rooms2 = item.chat_rooms) === null || _item$chat_rooms2 === void 0 ? void 0 : _item$chat_rooms2.name,\n          createdBy: (_item$chat_rooms3 = item.chat_rooms) === null || _item$chat_rooms3 === void 0 ? void 0 : _item$chat_rooms3.created_by,\n          createdAt: (_item$chat_rooms4 = item.chat_rooms) === null || _item$chat_rooms4 === void 0 ? void 0 : _item$chat_rooms4.created_at,\n          role: item.role\n        };\n      }).filter(r => r.id);\n      setRooms(mapped);\n      if (!activeRoom && mapped.length > 0) {\n        setActiveRoom(mapped[0]);\n      }\n      setLoading(false);\n    };\n    loadRooms();\n  }, [user]);\n  useEffect(() => {\n    const loadRoomData = async () => {\n      if (!(activeRoom !== null && activeRoom !== void 0 && activeRoom.id)) return;\n      setLoading(true);\n      const {\n        data: membersData\n      } = await supabase.from('chat_room_members').select('user_id, role').eq('room_id', activeRoom.id);\n      const {\n        data: messagesData\n      } = await supabase.from('chat_messages').select('id, room_id, user_id, content, attachment_url, attachment_name, attachment_type, attachment_size, created_at').eq('room_id', activeRoom.id).order('created_at', {\n        ascending: true\n      });\n      setMembers((membersData || []).map(m => ({\n        userId: m.user_id,\n        role: m.role,\n        profile: profileLookup.get(m.user_id) || null\n      })));\n      const enriched = (messagesData || []).map(msg => ({\n        ...msg,\n        profile: memberMap.get(msg.user_id) || profileLookup.get(msg.user_id) || null\n      }));\n      setMessages(enriched);\n      setLoading(false);\n    };\n    loadRoomData();\n  }, [activeRoom === null || activeRoom === void 0 ? void 0 : activeRoom.id, profileLookup, memberMap]);\n  useEffect(() => {\n    if (!(activeRoom !== null && activeRoom !== void 0 && activeRoom.id)) return;\n    const channel = supabase.channel(`chat-room-${activeRoom.id}`).on('postgres_changes', {\n      event: 'INSERT',\n      schema: 'public',\n      table: 'chat_messages',\n      filter: `room_id=eq.${activeRoom.id}`\n    }, payload => {\n      const incoming = payload.new;\n      setMessages(prev => {\n        if (prev.find(m => m.id === incoming.id)) return prev;\n        return [...prev, {\n          ...incoming,\n          profile: memberMap.get(incoming.user_id) || null\n        }];\n      });\n    }).subscribe();\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [activeRoom === null || activeRoom === void 0 ? void 0 : activeRoom.id, memberMap]);\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  }, [messages]);\n  const handleCreateRoom = async () => {\n    if (!newRoomName.trim() || !(user !== null && user !== void 0 && user.id)) return;\n    setLoading(true);\n    setStatus('');\n    const {\n      data: roomData,\n      error: roomError\n    } = await supabase.from('chat_rooms').insert([{\n      name: newRoomName.trim(),\n      created_by: user.id\n    }]).select('id, name, created_by, created_at').single();\n    if (roomError || !roomData) {\n      setStatus('Erro ao criar sala.');\n      setLoading(false);\n      return;\n    }\n    const membersToInsert = [{\n      room_id: roomData.id,\n      user_id: user.id,\n      role: 'owner'\n    }, ...selectedMemberIds.filter(id => id !== user.id).map(id => ({\n      room_id: roomData.id,\n      user_id: id,\n      role: 'member'\n    }))];\n    await supabase.from('chat_room_members').insert(membersToInsert);\n    setRooms(prev => [...prev, {\n      id: roomData.id,\n      name: roomData.name,\n      createdBy: roomData.created_by,\n      createdAt: roomData.created_at,\n      role: 'owner'\n    }]);\n    setActiveRoom({\n      id: roomData.id,\n      name: roomData.name,\n      createdBy: roomData.created_by,\n      createdAt: roomData.created_at,\n      role: 'owner'\n    });\n    setNewRoomName('');\n    setSelectedMemberIds([]);\n    setShowCreateModal(false);\n    setLoading(false);\n  };\n  const handleAddMembers = async () => {\n    if (!(activeRoom !== null && activeRoom !== void 0 && activeRoom.id) || selectedMemberIds.length === 0) return;\n    setLoading(true);\n    const payload = selectedMemberIds.map(id => ({\n      room_id: activeRoom.id,\n      user_id: id,\n      role: 'member'\n    }));\n    await supabase.from('chat_room_members').insert(payload);\n    setSelectedMemberIds([]);\n    setShowMembersModal(false);\n    setLoading(false);\n  };\n  const handleSendMessage = async () => {\n    if (!(activeRoom !== null && activeRoom !== void 0 && activeRoom.id) || !messageText.trim() && !attachment || !(user !== null && user !== void 0 && user.id)) return;\n    setLoading(true);\n    setStatus('');\n    let attachmentUrl = null;\n    let attachmentName = null;\n    let attachmentType = null;\n    let attachmentSize = null;\n    if (attachment) {\n      if (attachment.size > 10 * 1024 * 1024) {\n        setStatus('Arquivo muito grande. Máximo 10MB.');\n        setLoading(false);\n        return;\n      }\n      const safeName = attachment.name.replace(/\\s+/g, '-');\n      const filePath = `rooms/${activeRoom.id}/${user.id}/${Date.now()}-${safeName}`;\n      const {\n        error: uploadError\n      } = await supabase.storage.from('chat-files').upload(filePath, attachment);\n      if (uploadError) {\n        setStatus('Erro ao enviar arquivo.');\n        setLoading(false);\n        return;\n      }\n      const {\n        data: {\n          publicUrl\n        }\n      } = supabase.storage.from('chat-files').getPublicUrl(filePath);\n      attachmentUrl = publicUrl;\n      attachmentName = attachment.name;\n      attachmentType = attachment.type;\n      attachmentSize = attachment.size;\n    }\n    const {\n      error\n    } = await supabase.from('chat_messages').insert([{\n      room_id: activeRoom.id,\n      user_id: user.id,\n      content: messageText.trim(),\n      attachment_url: attachmentUrl,\n      attachment_name: attachmentName,\n      attachment_type: attachmentType,\n      attachment_size: attachmentSize\n    }]);\n    if (error) {\n      setStatus('Erro ao enviar mensagem.');\n    } else {\n      setMessageText('');\n      setAttachment(null);\n    }\n    setLoading(false);\n  };\n  const formatDate = value => {\n    if (!value) return '';\n    return new Date(value).toLocaleString('pt-BR');\n  };\n  const availableProfiles = profiles.filter(p => !members.find(m => m.userId === p.id));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"admin-topbar chat-topbar\",\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/dashboard\",\n        className: \"admin-logo\",\n        \"aria-label\": \"Voltar ao in\\xEDcio\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/logo-proteq.png\",\n          alt: \"PROTEQ Logo\",\n          className: \"admin-logo-image\",\n          onError: e => e.target.style.display = 'none'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ProfileMenu, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-layout\",\n      children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n        className: \"chat-sidebar\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-sidebar-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-sidebar-title\",\n            children: [/*#__PURE__*/_jsxDEV(MessageCircle, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Conversas\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"chat-action-button\",\n            onClick: () => setShowCreateModal(true),\n            children: [/*#__PURE__*/_jsxDEV(Plus, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this), \"Nova sala\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-room-list\",\n          children: [rooms.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"chat-empty\",\n            children: \"Nenhuma sala criada.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 15\n          }, this), rooms.map(room => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `chat-room-item ${(activeRoom === null || activeRoom === void 0 ? void 0 : activeRoom.id) === room.id ? 'active' : ''}`,\n            onClick: () => setActiveRoom(room),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-room-name\",\n              children: room.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-room-meta\",\n              children: room.role === 'owner' ? 'Administrador' : 'Membro'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 17\n            }, this)]\n          }, room.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"chat-main\",\n        children: !activeRoom ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-empty-state\",\n          children: [/*#__PURE__*/_jsxDEV(MessageCircle, {\n            className: \"w-10 h-10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Selecione uma sala\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Crie ou escolha uma conversa para come\\xE7ar.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: activeRoom.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [members.length, \" participantes\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-header-actions\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"chat-action-button ghost\",\n                onClick: () => setShowMembersModal(true),\n                children: [/*#__PURE__*/_jsxDEV(Users, {\n                  className: \"w-4 h-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 359,\n                  columnNumber: 21\n                }, this), \"Adicionar membros\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 355,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-messages\",\n            children: [loading && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-empty\",\n              children: \"Carregando...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 29\n            }, this), !loading && messages.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-empty\",\n              children: \"Nenhuma mensagem ainda.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 19\n            }, this), messages.map(msg => {\n              var _profile$email, _profile$email$;\n              const profile = msg.profile || memberMap.get(msg.user_id) || profileLookup.get(msg.user_id);\n              const initials = profile !== null && profile !== void 0 && profile.nome ? profile.nome.split(' ')[0][0].toUpperCase() : (profile === null || profile === void 0 ? void 0 : (_profile$email = profile.email) === null || _profile$email === void 0 ? void 0 : (_profile$email$ = _profile$email[0]) === null || _profile$email$ === void 0 ? void 0 : _profile$email$.toUpperCase()) || 'U';\n              const isOwn = msg.user_id === (user === null || user === void 0 ? void 0 : user.id);\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `chat-message ${isOwn ? 'own' : ''}`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"chat-avatar\",\n                  children: profile !== null && profile !== void 0 && profile.foto_url || profile !== null && profile !== void 0 && profile.avatar_url ? /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: profile.foto_url || profile.avatar_url,\n                    alt: (profile === null || profile === void 0 ? void 0 : profile.nome) || (profile === null || profile === void 0 ? void 0 : profile.email) || 'Usuário'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 380,\n                    columnNumber: 27\n                  }, this) : initials\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 378,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"chat-bubble\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"chat-bubble-header\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      children: (profile === null || profile === void 0 ? void 0 : profile.nome) || (profile === null || profile === void 0 ? void 0 : profile.email) || 'Usuário'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 390,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: formatDate(msg.created_at)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 391,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 389,\n                    columnNumber: 25\n                  }, this), msg.content && /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"chat-text\",\n                    children: msg.content\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 393,\n                    columnNumber: 41\n                  }, this), msg.attachment_url && /*#__PURE__*/_jsxDEV(\"a\", {\n                    href: msg.attachment_url,\n                    target: \"_blank\",\n                    rel: \"noreferrer\",\n                    className: \"chat-attachment\",\n                    children: [/*#__PURE__*/_jsxDEV(Paperclip, {\n                      className: \"w-4 h-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 401,\n                      columnNumber: 29\n                    }, this), msg.attachment_name || 'Arquivo']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 395,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 388,\n                  columnNumber: 23\n                }, this)]\n              }, msg.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 21\n              }, this);\n            }), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: messagesEndRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 409,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-composer\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"chat-icon-button\",\n              onClick: () => {\n                var _fileInputRef$current;\n                return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n              },\n              children: /*#__PURE__*/_jsxDEV(Paperclip, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 417,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              ref: fileInputRef,\n              type: \"file\",\n              className: \"hidden\",\n              onChange: e => {\n                var _e$target$files;\n                return setAttachment(((_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0]) || null);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: messageText,\n              onChange: e => setMessageText(e.target.value),\n              placeholder: \"Digite sua mensagem...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"chat-send\",\n              onClick: handleSendMessage,\n              children: [/*#__PURE__*/_jsxDEV(Send, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 432,\n                columnNumber: 19\n              }, this), \"Enviar\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 431,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 15\n          }, this), attachment && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-attachment-preview\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: attachment.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setAttachment(null),\n              children: /*#__PURE__*/_jsxDEV(X, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 440,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 17\n          }, this), status && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-status\",\n            children: status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 26\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 7\n    }, this), showCreateModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-modal-backdrop\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-modal\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Criar sala\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowCreateModal(false),\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 456,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-modal-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Nome da sala\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: newRoomName,\n            onChange: e => setNewRoomName(e.target.value),\n            placeholder: \"Ex: Financeiro\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Adicionar membros\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 467,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-modal-list\",\n            children: profiles.map(profile => /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"chat-modal-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                checked: selectedMemberIds.includes(profile.id),\n                onChange: () => {\n                  setSelectedMemberIds(prev => prev.includes(profile.id) ? prev.filter(id => id !== profile.id) : [...prev, profile.id]);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 471,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: profile.nome || profile.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 21\n              }, this)]\n            }, profile.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 470,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-modal-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowCreateModal(false),\n            className: \"ghost\",\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleCreateRoom,\n            className: \"primary\",\n            disabled: loading,\n            children: \"Criar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 491,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 9\n    }, this), showMembersModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-modal-backdrop\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-modal\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Adicionar membros\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 503,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowMembersModal(false),\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 505,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 504,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 502,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-modal-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Usu\\xE1rios dispon\\xEDveis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 509,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-modal-list\",\n            children: [availableProfiles.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"chat-empty\",\n              children: \"Todos j\\xE1 est\\xE3o na sala.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 19\n            }, this), availableProfiles.map(profile => /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"chat-modal-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                checked: selectedMemberIds.includes(profile.id),\n                onChange: () => {\n                  setSelectedMemberIds(prev => prev.includes(profile.id) ? prev.filter(id => id !== profile.id) : [...prev, profile.id]);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 516,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: profile.nome || profile.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 527,\n                columnNumber: 21\n              }, this)]\n            }, profile.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 19\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 510,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 508,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-modal-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowMembersModal(false),\n            className: \"ghost\",\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 533,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleAddMembers,\n            className: \"primary\",\n            disabled: loading,\n            children: \"Adicionar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 536,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 501,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 292,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatPage, \"Y3EIbI16pzHvG/vldJBKj1pmMaE=\", false, function () {\n  return [useAuth];\n});\n_c = ChatPage;\nexport default ChatPage;\nvar _c;\n$RefreshReg$(_c, \"ChatPage\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","Link","MessageCircle","Plus","Users","X","Send","Paperclip","supabase","useAuth","ProfileMenu","jsxDEV","_jsxDEV","Fragment","_Fragment","ChatPage","_s","user","rooms","setRooms","activeRoom","setActiveRoom","messages","setMessages","members","setMembers","profiles","setProfiles","messageText","setMessageText","attachment","setAttachment","loading","setLoading","status","setStatus","showCreateModal","setShowCreateModal","showMembersModal","setShowMembersModal","newRoomName","setNewRoomName","selectedMemberIds","setSelectedMemberIds","messagesEndRef","fileInputRef","profileLookup","map","Map","forEach","p","id","set","memberMap","m","userId","profile","get","loadProfiles","data","from","select","loadRooms","error","eq","mapped","item","_item$chat_rooms","_item$chat_rooms2","_item$chat_rooms3","_item$chat_rooms4","chat_rooms","name","createdBy","created_by","createdAt","created_at","role","filter","r","length","loadRoomData","membersData","messagesData","order","ascending","user_id","enriched","msg","channel","on","event","schema","table","payload","incoming","new","prev","find","subscribe","removeChannel","current","scrollIntoView","behavior","handleCreateRoom","trim","roomData","roomError","insert","single","membersToInsert","room_id","handleAddMembers","handleSendMessage","attachmentUrl","attachmentName","attachmentType","attachmentSize","size","safeName","replace","filePath","Date","now","uploadError","storage","upload","publicUrl","getPublicUrl","type","content","attachment_url","attachment_name","attachment_type","attachment_size","formatDate","value","toLocaleString","availableProfiles","className","children","to","src","alt","onError","e","target","style","display","fileName","_jsxFileName","lineNumber","columnNumber","onClick","room","_profile$email","_profile$email$","initials","nome","split","toUpperCase","email","isOwn","foto_url","avatar_url","href","rel","ref","_fileInputRef$current","click","onChange","_e$target$files","files","placeholder","checked","includes","disabled","_c","$RefreshReg$"],"sources":["C:/Users/ResTIC16/Desktop/gest-o-financeira/frontend/src/pages/ChatPage.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { MessageCircle, Plus, Users, X, Send, Paperclip } from 'lucide-react';\nimport { supabase } from '../lib/supabaseClient';\nimport { useAuth } from '../contexts/AuthContext';\nimport ProfileMenu from '../components/ProfileMenu';\nimport '../pages/AdminPage.css';\nimport './ChatPage.css';\n\nconst ChatPage = () => {\n  const { user } = useAuth();\n  const [rooms, setRooms] = useState([]);\n  const [activeRoom, setActiveRoom] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [members, setMembers] = useState([]);\n  const [profiles, setProfiles] = useState([]);\n  const [messageText, setMessageText] = useState('');\n  const [attachment, setAttachment] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [status, setStatus] = useState('');\n\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [showMembersModal, setShowMembersModal] = useState(false);\n  const [newRoomName, setNewRoomName] = useState('');\n  const [selectedMemberIds, setSelectedMemberIds] = useState([]);\n\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  const profileLookup = useMemo(() => {\n    const map = new Map();\n    profiles.forEach((p) => {\n      if (p?.id) map.set(p.id, p);\n    });\n    return map;\n  }, [profiles]);\n\n  const memberMap = useMemo(() => {\n    const map = new Map();\n    members.forEach((m) => {\n      if (m.userId) {\n        map.set(m.userId, m.profile || profileLookup.get(m.userId) || null);\n      }\n    });\n    return map;\n  }, [members, profileLookup]);\n\n  useEffect(() => {\n    const loadProfiles = async () => {\n      const { data } = await supabase\n        .from('profiles')\n        .select('id, nome, email, foto_url, avatar_url');\n      setProfiles(data || []);\n    };\n    loadProfiles();\n  }, []);\n\n  useEffect(() => {\n    const loadRooms = async () => {\n      if (!user?.id) return;\n      setLoading(true);\n      const { data, error } = await supabase\n        .from('chat_room_members')\n        .select('room_id, role, chat_rooms(id, name, created_by, created_at)')\n        .eq('user_id', user.id);\n\n      if (error) {\n        setStatus('Erro ao carregar salas.');\n        setLoading(false);\n        return;\n      }\n\n      const mapped = (data || [])\n        .map((item) => ({\n          id: item.chat_rooms?.id,\n          name: item.chat_rooms?.name,\n          createdBy: item.chat_rooms?.created_by,\n          createdAt: item.chat_rooms?.created_at,\n          role: item.role\n        }))\n        .filter((r) => r.id);\n\n      setRooms(mapped);\n      if (!activeRoom && mapped.length > 0) {\n        setActiveRoom(mapped[0]);\n      }\n      setLoading(false);\n    };\n    loadRooms();\n  }, [user]);\n\n  useEffect(() => {\n    const loadRoomData = async () => {\n      if (!activeRoom?.id) return;\n      setLoading(true);\n      const { data: membersData } = await supabase\n        .from('chat_room_members')\n        .select('user_id, role')\n        .eq('room_id', activeRoom.id);\n\n      const { data: messagesData } = await supabase\n        .from('chat_messages')\n        .select('id, room_id, user_id, content, attachment_url, attachment_name, attachment_type, attachment_size, created_at')\n        .eq('room_id', activeRoom.id)\n        .order('created_at', { ascending: true });\n\n      setMembers(\n        (membersData || []).map((m) => ({\n          userId: m.user_id,\n          role: m.role,\n          profile: profileLookup.get(m.user_id) || null\n        }))\n      );\n\n      const enriched = (messagesData || []).map((msg) => ({\n        ...msg,\n        profile: memberMap.get(msg.user_id) || profileLookup.get(msg.user_id) || null\n      }));\n      setMessages(enriched);\n      setLoading(false);\n    };\n    loadRoomData();\n  }, [activeRoom?.id, profileLookup, memberMap]);\n\n  useEffect(() => {\n    if (!activeRoom?.id) return;\n    const channel = supabase\n      .channel(`chat-room-${activeRoom.id}`)\n      .on(\n        'postgres_changes',\n        {\n          event: 'INSERT',\n          schema: 'public',\n          table: 'chat_messages',\n          filter: `room_id=eq.${activeRoom.id}`\n        },\n        (payload) => {\n          const incoming = payload.new;\n          setMessages((prev) => {\n            if (prev.find((m) => m.id === incoming.id)) return prev;\n            return [\n              ...prev,\n              { ...incoming, profile: memberMap.get(incoming.user_id) || null }\n            ];\n          });\n        }\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [activeRoom?.id, memberMap]);\n\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n    }\n  }, [messages]);\n\n  const handleCreateRoom = async () => {\n    if (!newRoomName.trim() || !user?.id) return;\n    setLoading(true);\n    setStatus('');\n\n    const { data: roomData, error: roomError } = await supabase\n      .from('chat_rooms')\n      .insert([{ name: newRoomName.trim(), created_by: user.id }])\n      .select('id, name, created_by, created_at')\n      .single();\n\n    if (roomError || !roomData) {\n      setStatus('Erro ao criar sala.');\n      setLoading(false);\n      return;\n    }\n\n    const membersToInsert = [\n      { room_id: roomData.id, user_id: user.id, role: 'owner' },\n      ...selectedMemberIds\n        .filter((id) => id !== user.id)\n        .map((id) => ({ room_id: roomData.id, user_id: id, role: 'member' }))\n    ];\n\n    await supabase.from('chat_room_members').insert(membersToInsert);\n\n    setRooms((prev) => [\n      ...prev,\n      {\n        id: roomData.id,\n        name: roomData.name,\n        createdBy: roomData.created_by,\n        createdAt: roomData.created_at,\n        role: 'owner'\n      }\n    ]);\n    setActiveRoom({\n      id: roomData.id,\n      name: roomData.name,\n      createdBy: roomData.created_by,\n      createdAt: roomData.created_at,\n      role: 'owner'\n    });\n    setNewRoomName('');\n    setSelectedMemberIds([]);\n    setShowCreateModal(false);\n    setLoading(false);\n  };\n\n  const handleAddMembers = async () => {\n    if (!activeRoom?.id || selectedMemberIds.length === 0) return;\n    setLoading(true);\n    const payload = selectedMemberIds.map((id) => ({\n      room_id: activeRoom.id,\n      user_id: id,\n      role: 'member'\n    }));\n    await supabase.from('chat_room_members').insert(payload);\n    setSelectedMemberIds([]);\n    setShowMembersModal(false);\n    setLoading(false);\n  };\n\n  const handleSendMessage = async () => {\n    if (!activeRoom?.id || (!messageText.trim() && !attachment) || !user?.id) return;\n    setLoading(true);\n    setStatus('');\n\n    let attachmentUrl = null;\n    let attachmentName = null;\n    let attachmentType = null;\n    let attachmentSize = null;\n\n    if (attachment) {\n      if (attachment.size > 10 * 1024 * 1024) {\n        setStatus('Arquivo muito grande. Máximo 10MB.');\n        setLoading(false);\n        return;\n      }\n\n      const safeName = attachment.name.replace(/\\s+/g, '-');\n      const filePath = `rooms/${activeRoom.id}/${user.id}/${Date.now()}-${safeName}`;\n      const { error: uploadError } = await supabase.storage\n        .from('chat-files')\n        .upload(filePath, attachment);\n\n      if (uploadError) {\n        setStatus('Erro ao enviar arquivo.');\n        setLoading(false);\n        return;\n      }\n\n      const { data: { publicUrl } } = supabase.storage\n        .from('chat-files')\n        .getPublicUrl(filePath);\n\n      attachmentUrl = publicUrl;\n      attachmentName = attachment.name;\n      attachmentType = attachment.type;\n      attachmentSize = attachment.size;\n    }\n\n    const { error } = await supabase\n      .from('chat_messages')\n      .insert([{\n        room_id: activeRoom.id,\n        user_id: user.id,\n        content: messageText.trim(),\n        attachment_url: attachmentUrl,\n        attachment_name: attachmentName,\n        attachment_type: attachmentType,\n        attachment_size: attachmentSize\n      }]);\n\n    if (error) {\n      setStatus('Erro ao enviar mensagem.');\n    } else {\n      setMessageText('');\n      setAttachment(null);\n    }\n    setLoading(false);\n  };\n\n  const formatDate = (value) => {\n    if (!value) return '';\n    return new Date(value).toLocaleString('pt-BR');\n  };\n\n  const availableProfiles = profiles.filter((p) => !members.find((m) => m.userId === p.id));\n\n  return (\n    <div className=\"chat-page\">\n      <div className=\"admin-topbar chat-topbar\">\n        <Link to=\"/dashboard\" className=\"admin-logo\" aria-label=\"Voltar ao início\">\n          <img\n            src=\"/logo-proteq.png\"\n            alt=\"PROTEQ Logo\"\n            className=\"admin-logo-image\"\n            onError={(e) => (e.target.style.display = 'none')}\n          />\n        </Link>\n        <ProfileMenu />\n      </div>\n\n      <div className=\"chat-layout\">\n        <aside className=\"chat-sidebar\">\n          <div className=\"chat-sidebar-header\">\n            <div className=\"chat-sidebar-title\">\n              <MessageCircle className=\"w-5 h-5\" />\n              <span>Conversas</span>\n            </div>\n            <button\n              className=\"chat-action-button\"\n              onClick={() => setShowCreateModal(true)}\n            >\n              <Plus className=\"w-4 h-4\" />\n              Nova sala\n            </button>\n          </div>\n\n          <div className=\"chat-room-list\">\n            {rooms.length === 0 && (\n              <p className=\"chat-empty\">Nenhuma sala criada.</p>\n            )}\n            {rooms.map((room) => (\n              <button\n                key={room.id}\n                className={`chat-room-item ${activeRoom?.id === room.id ? 'active' : ''}`}\n                onClick={() => setActiveRoom(room)}\n              >\n                <div className=\"chat-room-name\">{room.name}</div>\n                <div className=\"chat-room-meta\">\n                  {room.role === 'owner' ? 'Administrador' : 'Membro'}\n                </div>\n              </button>\n            ))}\n          </div>\n        </aside>\n\n        <main className=\"chat-main\">\n          {!activeRoom ? (\n            <div className=\"chat-empty-state\">\n              <MessageCircle className=\"w-10 h-10\" />\n              <h2>Selecione uma sala</h2>\n              <p>Crie ou escolha uma conversa para começar.</p>\n            </div>\n          ) : (\n            <>\n              <div className=\"chat-header\">\n                <div>\n                  <h2>{activeRoom.name}</h2>\n                  <p>{members.length} participantes</p>\n                </div>\n                <div className=\"chat-header-actions\">\n                  <button\n                    className=\"chat-action-button ghost\"\n                    onClick={() => setShowMembersModal(true)}\n                  >\n                    <Users className=\"w-4 h-4\" />\n                    Adicionar membros\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"chat-messages\">\n                {loading && <div className=\"chat-empty\">Carregando...</div>}\n                {!loading && messages.length === 0 && (\n                  <div className=\"chat-empty\">Nenhuma mensagem ainda.</div>\n                )}\n                {messages.map((msg) => {\n                  const profile = msg.profile || memberMap.get(msg.user_id) || profileLookup.get(msg.user_id);\n                  const initials = profile?.nome\n                    ? profile.nome.split(' ')[0][0].toUpperCase()\n                    : profile?.email?.[0]?.toUpperCase() || 'U';\n                  const isOwn = msg.user_id === user?.id;\n                  return (\n                    <div key={msg.id} className={`chat-message ${isOwn ? 'own' : ''}`}>\n                      <div className=\"chat-avatar\">\n                        {profile?.foto_url || profile?.avatar_url ? (\n                          <img\n                            src={profile.foto_url || profile.avatar_url}\n                            alt={profile?.nome || profile?.email || 'Usuário'}\n                          />\n                        ) : (\n                          initials\n                        )}\n                      </div>\n                      <div className=\"chat-bubble\">\n                        <div className=\"chat-bubble-header\">\n                          <span>{profile?.nome || profile?.email || 'Usuário'}</span>\n                          <span>{formatDate(msg.created_at)}</span>\n                        </div>\n                        {msg.content && <p className=\"chat-text\">{msg.content}</p>}\n                        {msg.attachment_url && (\n                          <a\n                            href={msg.attachment_url}\n                            target=\"_blank\"\n                            rel=\"noreferrer\"\n                            className=\"chat-attachment\"\n                          >\n                            <Paperclip className=\"w-4 h-4\" />\n                            {msg.attachment_name || 'Arquivo'}\n                          </a>\n                        )}\n                      </div>\n                    </div>\n                  );\n                })}\n                <div ref={messagesEndRef} />\n              </div>\n\n              <div className=\"chat-composer\">\n                <button\n                  className=\"chat-icon-button\"\n                  onClick={() => fileInputRef.current?.click()}\n                >\n                  <Paperclip className=\"w-4 h-4\" />\n                </button>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  className=\"hidden\"\n                  onChange={(e) => setAttachment(e.target.files?.[0] || null)}\n                />\n                <input\n                  type=\"text\"\n                  value={messageText}\n                  onChange={(e) => setMessageText(e.target.value)}\n                  placeholder=\"Digite sua mensagem...\"\n                />\n                <button className=\"chat-send\" onClick={handleSendMessage}>\n                  <Send className=\"w-4 h-4\" />\n                  Enviar\n                </button>\n              </div>\n              {attachment && (\n                <div className=\"chat-attachment-preview\">\n                  <span>{attachment.name}</span>\n                  <button onClick={() => setAttachment(null)}>\n                    <X className=\"w-4 h-4\" />\n                  </button>\n                </div>\n              )}\n              {status && <div className=\"chat-status\">{status}</div>}\n            </>\n          )}\n        </main>\n      </div>\n\n      {showCreateModal && (\n        <div className=\"chat-modal-backdrop\">\n          <div className=\"chat-modal\">\n            <div className=\"chat-modal-header\">\n              <h3>Criar sala</h3>\n              <button onClick={() => setShowCreateModal(false)}>\n                <X className=\"w-4 h-4\" />\n              </button>\n            </div>\n            <div className=\"chat-modal-body\">\n              <label>Nome da sala</label>\n              <input\n                type=\"text\"\n                value={newRoomName}\n                onChange={(e) => setNewRoomName(e.target.value)}\n                placeholder=\"Ex: Financeiro\"\n              />\n              <label>Adicionar membros</label>\n              <div className=\"chat-modal-list\">\n                {profiles.map((profile) => (\n                  <label key={profile.id} className=\"chat-modal-item\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedMemberIds.includes(profile.id)}\n                      onChange={() => {\n                        setSelectedMemberIds((prev) =>\n                          prev.includes(profile.id)\n                            ? prev.filter((id) => id !== profile.id)\n                            : [...prev, profile.id]\n                        );\n                      }}\n                    />\n                    <span>{profile.nome || profile.email}</span>\n                  </label>\n                ))}\n              </div>\n            </div>\n            <div className=\"chat-modal-actions\">\n              <button onClick={() => setShowCreateModal(false)} className=\"ghost\">\n                Cancelar\n              </button>\n              <button onClick={handleCreateRoom} className=\"primary\" disabled={loading}>\n                Criar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showMembersModal && (\n        <div className=\"chat-modal-backdrop\">\n          <div className=\"chat-modal\">\n            <div className=\"chat-modal-header\">\n              <h3>Adicionar membros</h3>\n              <button onClick={() => setShowMembersModal(false)}>\n                <X className=\"w-4 h-4\" />\n              </button>\n            </div>\n            <div className=\"chat-modal-body\">\n              <label>Usuários disponíveis</label>\n              <div className=\"chat-modal-list\">\n                {availableProfiles.length === 0 && (\n                  <p className=\"chat-empty\">Todos já estão na sala.</p>\n                )}\n                {availableProfiles.map((profile) => (\n                  <label key={profile.id} className=\"chat-modal-item\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedMemberIds.includes(profile.id)}\n                      onChange={() => {\n                        setSelectedMemberIds((prev) =>\n                          prev.includes(profile.id)\n                            ? prev.filter((id) => id !== profile.id)\n                            : [...prev, profile.id]\n                        );\n                      }}\n                    />\n                    <span>{profile.nome || profile.email}</span>\n                  </label>\n                ))}\n              </div>\n            </div>\n            <div className=\"chat-modal-actions\">\n              <button onClick={() => setShowMembersModal(false)} className=\"ghost\">\n                Cancelar\n              </button>\n              <button onClick={handleAddMembers} className=\"primary\" disabled={loading}>\n                Adicionar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ChatPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}